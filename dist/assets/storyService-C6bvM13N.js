import{a as r}from"./api-CqQ9tTrd.js";const n={async getDraft(){try{return(await r.get("/api/story-draft")).draft}catch{return null}},async saveDraft(e){await r.post("/api/story-draft",{draft:e})},async deleteDraft(){await r.delete("/api/story-draft")},async getStories(){return(await r.get("/api/stories")||[]).map(s=>({id:s.id,title:s.title,story_type:"",art_style:"",language:s.language,pages:s.pageCount||s.pages||0,created_at:s.createdAt,thumbnail:s.thumbnail}))},async getStory(e){try{const s=await r.get(`/api/stories/${e}`),t=s.storyText||s.story||"";return{id:s.id,title:s.title,storyType:s.storyType,artStyle:s.artStyle,language:s.language,languageLevel:s.languageLevel,pages:s.pages,dedication:s.dedication,characters:s.characters,mainCharacters:s.mainCharacters,relationships:s.relationships,relationshipTexts:s.relationshipTexts,outline:s.outline,story:t,sceneDescriptions:s.sceneDescriptions,sceneImages:s.sceneImages,coverImages:s.coverImages,thumbnail:s.thumbnail,createdAt:s.createdAt}}catch{return null}},async createStory(e){return{id:(await r.post("/api/stories",{title:e.title,story_type:e.storyType,art_style:e.artStyle,language:e.language,language_level:e.languageLevel,pages:e.pages,dedication:e.dedication,characters:e.characters,main_characters:e.mainCharacters,relationships:e.relationships,relationship_texts:e.relationshipTexts,outline:e.outline,story:e.story,scene_descriptions:e.sceneDescriptions,scene_images:e.sceneImages,cover_images:e.coverImages})).id}},async deleteStory(e){await r.delete(`/api/stories/${e}`)},async regenerateSceneDescription(e,s){return await r.post(`/api/stories/${e}/regenerate/scene-description/${s}`)},async regenerateImage(e,s){return{imageData:(await r.post(`/api/stories/${e}/regenerate/image/${s}`)).image_data}},async regenerateCover(e,s){return{imageData:(await r.post(`/api/stories/${e}/regenerate/cover/${s}`)).image_data}},async updatePage(e,s,t){await r.patch(`/api/stories/${e}/page/${s}`,{text:t.text,scene_description:t.sceneDescription,image_data:t.imageData})},async callClaude(e,s=8192){return(await r.post("/api/claude",{prompt:e,max_tokens:s})).content},async callGemini(e,s){return(await r.post("/api/gemini",{prompt:e,images:s})).content},async createStoryJob(e){return{jobId:(await r.post("/api/jobs/create-story",{storyType:e.storyType,storyTypeName:e.storyTypeName,artStyle:e.artStyle,language:e.language,languageLevel:e.languageLevel,pages:e.pages,dedication:e.dedication,storyDetails:e.storyDetails,characters:e.characters,mainCharacters:e.mainCharacters,relationships:e.relationships,relationshipTexts:e.relationshipTexts,skipImages:e.skipImages,imageGenMode:e.imageGenMode})).jobId}},async getJobStatus(e){const s=await r.get(`/api/jobs/${e}/status`),t=s.resultData;return{status:s.status,progress:{current:s.progress||0,total:100,message:s.progressMessage||""},result:t?{storyId:t.storyId||"",title:t.title||"",outline:t.outline||"",story:t.storyText||"",sceneDescriptions:t.sceneDescriptions||[],sceneImages:t.sceneImages||[],coverImages:t.coverImages}:void 0,error:s.errorMessage}},async generatePdf(e){const s=localStorage.getItem("auth_token"),t=await fetch(`/api/stories/${e}/pdf`,{headers:s?{Authorization:`Bearer ${s}`}:{}});if(!t.ok)throw new Error("Failed to generate PDF");return t.blob()},async createCheckoutSession(e){return await r.post("/api/stripe/create-checkout-session",{storyId:e})},async createPrintOrder(e,s){return await r.post("/api/print-provider/order",{storyId:e,shippingAddress:s})}};export{n as s};
