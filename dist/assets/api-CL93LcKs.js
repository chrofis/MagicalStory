class h{getToken(){return localStorage.getItem("auth_token")}getHeaders(t=!1){const e={"Content-Type":"application/json"};if(!t){const r=this.getToken();r&&(e.Authorization=`Bearer ${r}`)}return e}async request(t,e={}){const{skipAuth:r=!1,...a}=e,o=await fetch(`${t}`,{...a,headers:{...this.getHeaders(r),...a.headers}});if(!o.ok){const s=await o.json().catch(()=>({error:"Request failed"}));let n=s.error||s.message||`HTTP ${o.status}`;if(s.details){const c=s.details;c.message?n+=`: ${c.message}`:c.error?n+=`: ${c.error}`:typeof c=="string"&&(n+=`: ${c}`)}throw s.activeJobId&&(n+=`|ACTIVE_JOB:${s.activeJobId}`),new Error(n)}const i=await o.text();return i?JSON.parse(i):{}}async get(t,e){return this.request(t,{...e,method:"GET"})}async post(t,e,r){return this.request(t,{...r,method:"POST",body:e?JSON.stringify(e):void 0})}async put(t,e,r){return this.request(t,{...r,method:"PUT",body:e?JSON.stringify(e):void 0})}async patch(t,e,r){return this.request(t,{...r,method:"PATCH",body:e?JSON.stringify(e):void 0})}async delete(t,e){return this.request(t,{...e,method:"DELETE"})}async uploadFile(t,e,r){const a=new FormData;a.append("file",e),r&&Object.entries(r).forEach(([s,n])=>{a.append(s,n)});const o=this.getToken(),i=await fetch(`${t}`,{method:"POST",headers:o?{Authorization:`Bearer ${o}`}:{},body:a});if(!i.ok){const s=await i.json().catch(()=>({error:"Upload failed"}));throw new Error(s.error||"Upload failed")}return i.json()}}const f=new h;export{f as a};
