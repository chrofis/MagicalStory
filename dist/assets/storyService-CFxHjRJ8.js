import{a as r}from"./api-BJq6ZrNw.js";const n={async getDraft(){try{return(await r.get("/api/story-draft")).draft}catch{return null}},async saveDraft(e){await r.post("/api/story-draft",{draft:e})},async deleteDraft(){await r.delete("/api/story-draft")},async getStories(){return(await r.get("/api/stories")||[]).map(t=>({id:t.id,title:t.title,story_type:"",art_style:"",language:t.language,pages:t.pageCount||t.pages||0,created_at:t.createdAt,thumbnail:t.thumbnail}))},async getStory(e){try{const t=await r.get(`/api/stories/${e}`),s=t.storyText||t.story||"";return{id:t.id,title:t.title,storyType:t.storyType,artStyle:t.artStyle,language:t.language,languageLevel:t.languageLevel,pages:t.pages,dedication:t.dedication,characters:t.characters,mainCharacters:t.mainCharacters,relationships:t.relationships,relationshipTexts:t.relationshipTexts,outline:t.outline,story:s,sceneDescriptions:t.sceneDescriptions,sceneImages:t.sceneImages,coverImages:t.coverImages,thumbnail:t.thumbnail,createdAt:t.createdAt}}catch{return null}},async createStory(e){return{id:(await r.post("/api/stories",{title:e.title,story_type:e.storyType,art_style:e.artStyle,language:e.language,language_level:e.languageLevel,pages:e.pages,dedication:e.dedication,characters:e.characters,main_characters:e.mainCharacters,relationships:e.relationships,relationship_texts:e.relationshipTexts,outline:e.outline,story:e.story,scene_descriptions:e.sceneDescriptions,scene_images:e.sceneImages,cover_images:e.coverImages})).id}},async deleteStory(e){await r.delete(`/api/stories/${e}`)},async regenerateSceneDescription(e,t){return await r.post(`/api/stories/${e}/regenerate/scene-description/${t}`)},async regenerateImage(e,t){return{imageData:(await r.post(`/api/stories/${e}/regenerate/image/${t}`)).image_data}},async regenerateCover(e,t){const s=await r.post(`/api/stories/${e}/regenerate/cover/${t}`);return{imageData:s.imageData,description:s.description,prompt:s.prompt,qualityScore:s.qualityScore,qualityReasoning:s.qualityReasoning}},async updatePage(e,t,s){await r.patch(`/api/stories/${e}/page/${t}`,{text:s.text,scene_description:s.sceneDescription,image_data:s.imageData})},async callClaude(e,t=8192){return(await r.post("/api/claude",{prompt:e,max_tokens:t})).content},async callGemini(e,t){return(await r.post("/api/gemini",{prompt:e,images:t})).content},async createStoryJob(e){return{jobId:(await r.post("/api/jobs/create-story",{storyType:e.storyType,storyTypeName:e.storyTypeName,artStyle:e.artStyle,language:e.language,languageLevel:e.languageLevel,pages:e.pages,dedication:e.dedication,storyDetails:e.storyDetails,characters:e.characters,mainCharacters:e.mainCharacters,relationships:e.relationships,relationshipTexts:e.relationshipTexts,skipImages:e.skipImages,imageGenMode:e.imageGenMode})).jobId}},async getJobStatus(e){const t=await r.get(`/api/jobs/${e}/status`),s=t.resultData;return{status:t.status,progress:{current:t.progress||0,total:100,message:t.progressMessage||""},result:s?{storyId:s.storyId||"",title:s.title||"",outline:s.outline||"",story:s.storyText||"",sceneDescriptions:s.sceneDescriptions||[],sceneImages:s.sceneImages||[],coverImages:s.coverImages}:void 0,error:t.errorMessage}},async generatePdf(e){const t=localStorage.getItem("auth_token"),s=await fetch(`/api/stories/${e}/pdf`,{headers:t?{Authorization:`Bearer ${t}`}:{}});if(!s.ok)throw new Error("Failed to generate PDF");return s.blob()},async createCheckoutSession(e){return await r.post("/api/stripe/create-checkout-session",{storyId:e})},async createPrintOrder(e,t){return await r.post("/api/print-provider/order",{storyId:e,shippingAddress:t})},async getOrderStatus(e){return await r.get(`/api/stripe/order-status/${e}`)}};export{n as s};
