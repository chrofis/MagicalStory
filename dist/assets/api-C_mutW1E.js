class h{getToken(){return localStorage.getItem("auth_token")}getHeaders(t=!1){const e={"Content-Type":"application/json"};if(!t){const r=this.getToken();r&&(e.Authorization=`Bearer ${r}`)}return e}async request(t,e={}){const{skipAuth:r=!1,...n}=e,o=await fetch(`${t}`,{...n,headers:{...this.getHeaders(r),...n.headers}});if(!o.ok){const s=await o.json().catch(()=>({error:"Request failed"}));let i=s.error||s.message||`HTTP ${o.status}`;if(s.details){const c=s.details;c.message?i+=`: ${c.message}`:c.error?i+=`: ${c.error}`:typeof c=="string"&&(i+=`: ${c}`)}throw new Error(i)}const a=await o.text();return a?JSON.parse(a):{}}async get(t,e){return this.request(t,{...e,method:"GET"})}async post(t,e,r){return this.request(t,{...r,method:"POST",body:e?JSON.stringify(e):void 0})}async put(t,e,r){return this.request(t,{...r,method:"PUT",body:e?JSON.stringify(e):void 0})}async patch(t,e,r){return this.request(t,{...r,method:"PATCH",body:e?JSON.stringify(e):void 0})}async delete(t,e){return this.request(t,{...e,method:"DELETE"})}async uploadFile(t,e,r){const n=new FormData;n.append("file",e),r&&Object.entries(r).forEach(([s,i])=>{n.append(s,i)});const o=this.getToken(),a=await fetch(`${t}`,{method:"POST",headers:o?{Authorization:`Bearer ${o}`}:{},body:n});if(!a.ok){const s=await a.json().catch(()=>({error:"Upload failed"}));throw new Error(s.error||"Upload failed")}return a.json()}}const f=new h;export{f as a};
