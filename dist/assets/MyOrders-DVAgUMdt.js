import{c as h,u as b,a as N,b as v,j as e,e as m,E as k,C as w}from"./index-BxMPBtfs.js";import{u as C,b as c}from"./vendor-react-k5uhsfqB.js";import{N as S,P as x}from"./Textarea-WXlQT6ui.js";import"./Input-CY7H3ldg.js";import{a as L}from"./api-CL93LcKs.js";import{C as u}from"./clock-BehUOsND.js";import"./vendor-firebase-Ksn6Afo7.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=h("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=h("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),l=v("MyOrders");function E({status:t,language:s}){const a=(()=>{switch(t.toLowerCase()){case"delivered":return{icon:e.jsx(w,{size:14}),text:s==="de"?"Geliefert":s==="fr"?"Livré":"Delivered",className:"bg-green-100 text-green-800"};case"shipped":case"in_transit":return{icon:e.jsx(A,{size:14}),text:s==="de"?"Unterwegs":s==="fr"?"En transit":"Shipped",className:"bg-blue-100 text-blue-800"};case"cancelled":case"canceled":return{icon:e.jsx(u,{size:14}),text:s==="de"?"Storniert":s==="fr"?"Annulé":"Cancelled",className:"bg-red-100 text-red-800"};default:return{icon:e.jsx(u,{size:14}),text:s==="de"?"In Bearbeitung":s==="fr"?"En cours":"Processing",className:"bg-amber-100 text-amber-800"}}})();return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${a.className}`,children:[a.icon,a.text]})}function z({order:t,language:s,onViewStory:i,formatDate:a,formatAmount:d}){return e.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[s==="de"?"Bestellung":s==="fr"?"Commande":"Order"," #",t.id]}),e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:t.storyTitle})]}),e.jsx(E,{status:t.orderStatus,language:s})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:s==="de"?"Datum:":"Date:"})," ",a(t.createdAt)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:s==="de"?"Betrag:":s==="fr"?"Montant:":"Amount:"})," ",d(t.amount,t.currency)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:s==="de"?"Lieferadresse:":s==="fr"?"Adresse:":"Ship to:"})," ",t.shippingAddress.city,", ",t.shippingAddress.country]})]}),t.trackingNumber&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:s==="de"?"Sendungsverfolgung":s==="fr"?"Suivi":"Tracking"}),t.trackingUrl?e.jsxs("a",{href:t.trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm flex items-center gap-1",children:[t.trackingNumber,e.jsx(M,{size:12})]}):e.jsx("p",{className:"text-sm text-blue-700",children:t.trackingNumber})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:i,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm font-medium",children:[e.jsx(k,{size:16}),s==="de"?"Geschichte ansehen":s==="fr"?"Voir l'histoire":"View Story"]})})]})})}function V(){const t=C(),{language:s}=b(),{isAuthenticated:i}=N(),[a,d]=c.useState([]),[f,o]=c.useState(!0);c.useEffect(()=>{if(!i){t("/");return}p()},[i,t]);const p=async()=>{var r;l.debug("Loading orders...");try{o(!0);const n=await L.get("/api/user/orders");l.info("Loaded orders:",((r=n.orders)==null?void 0:r.length)||0),d(n.orders||[])}catch(n){l.error("Failed to load orders:",n)}finally{o(!1)}},y=c.useCallback(r=>{if(!r)return"-";try{return new Date(r).toLocaleDateString(s==="de"?"de-DE":s==="fr"?"fr-FR":"en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}},[s]),g=c.useCallback((r,n)=>{const j=r/100;return new Intl.NumberFormat(s==="de"?"de-CH":s==="fr"?"fr-CH":"en-US",{style:"currency",currency:n.toUpperCase()}).format(j)},[s]);return i?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(S,{currentStep:0}),e.jsxs("div",{className:"px-4 md:px-8 py-8 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(x,{size:28}),s==="de"?"Meine Bestellungen":s==="fr"?"Mes commandes":"My Orders"]})}),f?e.jsx(m,{message:s==="de"?"Laden...":s==="fr"?"Chargement...":"Loading..."}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:s==="de"?"Noch keine Bestellungen":s==="fr"?"Aucune commande":"No orders yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s==="de"?"Wenn du ein Buch bestellst, wird es hier angezeigt.":s==="fr"?"Quand vous commandez un livre, il apparaîtra ici.":"When you order a book, it will appear here."})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(r=>e.jsx(z,{order:r,language:s,onViewStory:()=>t(`/create?storyId=${r.storyId}`),formatDate:y,formatAmount:g},r.id))})]})]}):e.jsx(m,{fullScreen:!0})}export{V as default};
