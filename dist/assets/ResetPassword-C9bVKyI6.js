import{u as L,j as e,C as T}from"./index-B34Bllq6.js";import{f as S,u as C,b as a}from"./vendor-react-CqfXSjHo.js";import{B as l,I as x}from"./Input-BJ4rUPru.js";import{N as D,K as z,A as R}from"./Textarea-CPRQ1TTh.js";import{C as q}from"./circle-x-Ch0Gcs77.js";import"./vendor-firebase-DTVMaYMy.js";import"./sparkles-cPB_70jt.js";import"./book-open-DUvV4EqF.js";const I="",h={en:{title:"Reset Your Password",description:"Enter your new password below.",newPassword:"New password",confirmPassword:"Confirm password",resetPassword:"Reset Password",passwordsMatch:"Passwords must match",passwordTooShort:"Password must be at least 6 characters",success:"Password reset successfully!",successDesc:"You can now log in with your new password.",goToLogin:"Go to Login",invalidToken:"Invalid or Expired Link",invalidTokenDesc:"This password reset link is invalid or has expired. Please request a new one.",requestNewLink:"Request New Link"},de:{title:"Passwort zurücksetzen",description:"Geben Sie unten Ihr neues Passwort ein.",newPassword:"Neues Passwort",confirmPassword:"Passwort bestätigen",resetPassword:"Passwort zurücksetzen",passwordsMatch:"Passwörter müssen übereinstimmen",passwordTooShort:"Passwort muss mindestens 6 Zeichen lang sein",success:"Passwort erfolgreich zurückgesetzt!",successDesc:"Sie können sich jetzt mit Ihrem neuen Passwort anmelden.",goToLogin:"Zur Anmeldung",invalidToken:"Ungültiger oder abgelaufener Link",invalidTokenDesc:"Dieser Passwort-Reset-Link ist ungültig oder abgelaufen. Bitte fordern Sie einen neuen an.",requestNewLink:"Neuen Link anfordern"},fr:{title:"Reinitialiser le mot de passe",description:"Entrez votre nouveau mot de passe ci-dessous.",newPassword:"Nouveau mot de passe",confirmPassword:"Confirmer le mot de passe",resetPassword:"Reinitialiser le mot de passe",passwordsMatch:"Les mots de passe doivent correspondre",passwordTooShort:"Le mot de passe doit contenir au moins 6 caracteres",success:"Mot de passe reinitialise avec succes!",successDesc:"Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.",goToLogin:"Aller a la connexion",invalidToken:"Lien invalide ou expire",invalidTokenDesc:"Ce lien de reinitialisation de mot de passe est invalide ou a expire. Veuillez en demander un nouveau.",requestNewLink:"Demander un nouveau lien"}};function U(){const{token:g}=S(),d=C(),{language:f}=L(),s=h[f]||h.en,[n,v]=a.useState(""),[c,j]=a.useState(""),[i,u]=a.useState(!1),[m,t]=a.useState(""),[N,P]=a.useState(!1),[b,k]=a.useState(!1),y=async r=>{var w;if(r.preventDefault(),t(""),n.length<6){t(s.passwordTooShort);return}if(n!==c){t(s.passwordsMatch);return}u(!0);try{const o=await fetch(`${I}/api/auth/reset-password/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:g,password:n})}),p=await o.json();if(!o.ok){o.status===400&&((w=p.error)!=null&&w.includes("expired"))?k(!0):t(p.error||"Failed to reset password");return}P(!0)}catch{t("Failed to reset password. Please try again.")}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(D,{currentStep:0}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-8",children:N?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(T,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:s.success}),e.jsx("p",{className:"text-gray-500 mb-6",children:s.successDesc}),e.jsx(l,{onClick:()=>d("/?login=true"),variant:"primary",className:"w-full",children:s.goToLogin})]}):b?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:s.invalidToken}),e.jsx("p",{className:"text-gray-500 mb-6",children:s.invalidTokenDesc}),e.jsx(l,{onClick:()=>d("/?login=true"),variant:"primary",className:"w-full",children:s.requestNewLink})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(z,{className:"w-8 h-8 text-indigo-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-500",children:s.description})]}),m&&e.jsx(R,{variant:"error",className:"mb-4",children:m}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx(x,{type:"password",label:s.newPassword,value:n,onChange:r=>v(r.target.value),placeholder:"••••••••",required:!0,disabled:i}),e.jsx(x,{type:"password",label:s.confirmPassword,value:c,onChange:r=>j(r.target.value),placeholder:"••••••••",required:!0,disabled:i}),e.jsx(l,{type:"submit",variant:"primary",loading:i,className:"w-full",children:s.resetPassword})]})]})})})]})}export{U as default};
