import{c as C,f as R,T as V,C as L,I as q,j as s,X as B,u as _,a as E,L as G}from"./index-BhHzKzgK.js";import{b as p,u as U}from"./vendor-react-CHhk3aw2.js";import{B as z,I,b as i,a as J,C as M,U as H}from"./api-969hZrQ0.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=C("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=C("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=C("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=C("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=C("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=C("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Y={info:{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:q},success:{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:L},warning:{bg:"bg-yellow-50 border-yellow-200",text:"text-yellow-800",icon:V},error:{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:R}};function Q({children:e,variant:t="info",title:r,onClose:u,className:n=""}){const g=Y[t],l=g.icon;return s.jsxs("div",{className:`
        flex gap-3 p-4 rounded-lg border
        ${g.bg} ${g.text}
        ${n}
      `,role:"alert",children:[s.jsx(l,{className:"shrink-0 mt-0.5",size:20}),s.jsxs("div",{className:"flex-1",children:[r&&s.jsx("p",{className:"font-semibold mb-1",children:r}),s.jsx("div",{className:"text-sm",children:e})]}),u&&s.jsx("button",{onClick:u,className:"shrink-0 p-1 rounded hover:bg-black/10 transition-colors","aria-label":"Dismiss",children:s.jsx(B,{size:16})})]})}const D={en:{title:"Change Password",description:"Enter your current password and choose a new one.",currentPassword:"Current password",newPassword:"New password",confirmPassword:"Confirm new password",changePassword:"Change Password",passwordsMatch:"Passwords must match",passwordTooShort:"Password must be at least 6 characters",success:"Password changed successfully!",successDesc:"Your password has been updated.",close:"Close"},de:{title:"Passwort Ã¤ndern",description:"Geben Sie Ihr aktuelles Passwort ein und wÃ¤hlen Sie ein neues.",currentPassword:"Aktuelles Passwort",newPassword:"Neues Passwort",confirmPassword:"Neues Passwort bestÃ¤tigen",changePassword:"Passwort Ã¤ndern",passwordsMatch:"PasswÃ¶rter mÃ¼ssen Ã¼bereinstimmen",passwordTooShort:"Passwort muss mindestens 6 Zeichen lang sein",success:"Passwort erfolgreich geÃ¤ndert!",successDesc:"Ihr Passwort wurde aktualisiert.",close:"Schliessen"},fr:{title:"Changer le mot de passe",description:"Entrez votre mot de passe actuel et choisissez-en un nouveau.",currentPassword:"Mot de passe actuel",newPassword:"Nouveau mot de passe",confirmPassword:"Confirmer le nouveau mot de passe",changePassword:"Changer le mot de passe",passwordsMatch:"Les mots de passe doivent correspondre",passwordTooShort:"Le mot de passe doit contenir au moins 6 caracteres",success:"Mot de passe change avec succes!",successDesc:"Votre mot de passe a ete mis a jour.",close:"Fermer"}};function ee({isOpen:e,onClose:t}){const{language:r}=_(),{changePassword:u}=E(),n=D[r]||D.en,[g,l]=p.useState(""),[a,f]=p.useState(""),[m,c]=p.useState(""),[x,b]=p.useState(!1),[y,o]=p.useState(""),[w,v]=p.useState(!1);if(!e)return null;const k=async h=>{if(h.preventDefault(),o(""),a.length<6){o(n.passwordTooShort);return}if(a!==m){o(n.passwordsMatch);return}b(!0);try{await u(g,a),v(!0)}catch(N){o(N instanceof Error?N.message:"Failed to change password")}finally{b(!1)}},P=()=>{l(""),f(""),c(""),o(""),v(!1),t()};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-8 animate-fade-in relative",children:[s.jsx("button",{onClick:P,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(B,{size:20})}),w?s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(L,{className:"w-8 h-8 text-green-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:n.success}),s.jsx("p",{className:"text-gray-500 mb-6",children:n.successDesc}),s.jsx(z,{onClick:P,variant:"primary",className:"w-full",children:n.close})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(F,{className:"w-8 h-8 text-indigo-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:n.title}),s.jsx("p",{className:"text-gray-500",children:n.description})]}),y&&s.jsx(Q,{variant:"error",className:"mb-4",children:y}),s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[s.jsx(I,{type:"password",label:n.currentPassword,value:g,onChange:h=>l(h.target.value),placeholder:"********",required:!0,disabled:x}),s.jsx(I,{type:"password",label:n.newPassword,value:a,onChange:h=>f(h.target.value),placeholder:"********",required:!0,disabled:x}),s.jsx(I,{type:"password",label:n.confirmPassword,value:m,onChange:h=>c(h.target.value),placeholder:"********",required:!0,disabled:x}),s.jsx(z,{type:"submit",variant:"primary",loading:x,className:"w-full",children:n.changePassword})]})]})]})})}const se={async getDraft(){try{return(await i.get("/api/story-draft")).draft}catch{return null}},async saveDraft(e){await i.post("/api/story-draft",{draft:e})},async deleteDraft(){await i.delete("/api/story-draft")},async getStories(e){const t=new URLSearchParams;e!=null&&e.limit&&t.set("limit",String(e.limit)),e!=null&&e.offset&&t.set("offset",String(e.offset));const r=t.toString(),u=`/api/stories${r?`?${r}`:""}`,n=await i.get(u);return{stories:(n.stories||[]).map(l=>({id:l.id,title:l.title,story_type:"",art_style:"",language:l.language,pages:l.pageCount||l.pages||0,created_at:l.createdAt,hasThumbnail:l.hasThumbnail,isPartial:l.isPartial,generatedPages:l.generatedPages,totalPages:l.totalPages})),pagination:n.pagination}},async getStoryCover(e){try{return(await i.get(`/api/stories/${e}/cover`)).coverImage}catch{return null}},async getStory(e){try{const t=await i.get(`/api/stories/${e}`),r=t.storyText||t.story||"";return{id:t.id,title:t.title,storyType:t.storyType,artStyle:t.artStyle,language:t.language,languageLevel:t.languageLevel,pages:t.pages,dedication:t.dedication,characters:t.characters,mainCharacters:t.mainCharacters,relationships:t.relationships,relationshipTexts:t.relationshipTexts,outline:t.outline,outlinePrompt:t.outlinePrompt,story:r,storyTextPrompts:t.storyTextPrompts,visualBible:t.visualBible,sceneDescriptions:t.sceneDescriptions,sceneImages:t.sceneImages,coverImages:t.coverImages,thumbnail:t.thumbnail,createdAt:t.createdAt,isPartial:t.isPartial,failureReason:t.failureReason,generatedPages:t.generatedPages,totalPages:t.totalPages}}catch{return null}},async getStoryWithProgress(e,t){var r;try{const u=localStorage.getItem("auth_token"),n=await fetch(`/api/stories/${e}`,{headers:u?{Authorization:`Bearer ${u}`}:{}});if(!n.ok)throw new Error(`HTTP ${n.status}`);const g=n.headers.get("Content-Length"),l=g?parseInt(g,10):null,a=(r=n.body)==null?void 0:r.getReader();if(!a){const o=await n.json();return this.mapServerStoryToClient(o)}const f=[];let m=0;for(;;){const{done:o,value:w}=await a.read();if(o)break;f.push(w),m+=w.length,t(m,l)}const c=new Uint8Array(m);let x=0;for(const o of f)c.set(o,x),x+=o.length;const b=new TextDecoder().decode(c),y=JSON.parse(b);return this.mapServerStoryToClient(y)}catch{return null}},mapServerStoryToClient(e){const t=e.storyText||e.story||"";return{id:e.id,title:e.title,storyType:e.storyType,artStyle:e.artStyle,language:e.language,languageLevel:e.languageLevel,pages:e.pages,dedication:e.dedication,characters:e.characters,mainCharacters:e.mainCharacters,relationships:e.relationships,relationshipTexts:e.relationshipTexts,outline:e.outline,outlinePrompt:e.outlinePrompt,story:t,storyTextPrompts:e.storyTextPrompts,visualBible:e.visualBible,sceneDescriptions:e.sceneDescriptions,sceneImages:e.sceneImages,coverImages:e.coverImages,thumbnail:e.thumbnail,createdAt:e.createdAt,isPartial:e.isPartial,failureReason:e.failureReason,generatedPages:e.generatedPages,totalPages:e.totalPages}},async createStory(e){return{id:(await i.post("/api/stories",{title:e.title,story_type:e.storyType,art_style:e.artStyle,language:e.language,language_level:e.languageLevel,pages:e.pages,dedication:e.dedication,characters:e.characters,main_characters:e.mainCharacters,relationships:e.relationships,relationship_texts:e.relationshipTexts,outline:e.outline,story:e.story,scene_descriptions:e.sceneDescriptions,scene_images:e.sceneImages,cover_images:e.coverImages})).id}},async deleteStory(e){await i.delete(`/api/stories/${e}`)},async regenerateSceneDescription(e,t){return await i.post(`/api/stories/${e}/regenerate/scene-description/${t}`)},async regenerateImage(e,t){return await i.post(`/api/stories/${e}/regenerate/image/${t}`)},async regenerateCover(e,t){return await i.post(`/api/stories/${e}/regenerate/cover/${t}`)},async updatePage(e,t,r){await i.patch(`/api/stories/${e}/page/${t}`,{text:r.text,scene_description:r.sceneDescription,image_data:r.imageData})},async updateVisualBible(e,t){await i.put(`/api/stories/${e}/visual-bible`,{visualBible:t})},async editImage(e,t,r){return await i.post(`/api/stories/${e}/edit/image/${t}`,{editPrompt:r})},async editCover(e,t,r){return await i.post(`/api/stories/${e}/edit/cover/${t}`,{editPrompt:r})},async callClaude(e,t=8192){return(await i.post("/api/claude",{prompt:e,max_tokens:t})).content},async callGemini(e,t){return(await i.post("/api/gemini",{prompt:e,images:t})).content},async generateStoryIdeas(e){return await i.post("/api/generate-story-ideas",e)},async createStoryJob(e){return{jobId:(await i.post("/api/jobs/create-story",{storyType:e.storyType,storyTypeName:e.storyTypeName,artStyle:e.artStyle,language:e.language,languageLevel:e.languageLevel,pages:e.pages,dedication:e.dedication,storyDetails:e.storyDetails,characters:e.characters,mainCharacters:e.mainCharacters,relationships:e.relationships,relationshipTexts:e.relationshipTexts,skipImages:e.skipImages,imageGenMode:e.imageGenMode,skipOutline:e.skipOutline,skipText:e.skipText,skipSceneDescriptions:e.skipSceneDescriptions,skipCovers:e.skipCovers,modelOverrides:e.modelOverrides})).jobId}},async getJobStatus(e){const t=await i.get(`/api/jobs/${e}/status`),r=t.resultData;return{status:t.status,progress:{current:t.progress||0,total:100,message:t.progressMessage||""},result:r?{storyId:r.storyId||"",title:r.title||"",outline:r.outline||"",outlinePrompt:r.outlinePrompt,story:r.storyText||"",storyTextPrompts:r.storyTextPrompts,visualBible:r.visualBible,sceneDescriptions:r.sceneDescriptions||[],sceneImages:r.sceneImages||[],coverImages:r.coverImages}:void 0,partialCovers:t.partialCovers,storyText:t.storyText,partialPages:t.partialPages,currentCredits:t.currentCredits,error:t.errorMessage}},async cancelJob(e){return await i.post(`/api/jobs/${e}/cancel`)},async generatePdf(e){const t=localStorage.getItem("auth_token"),r=await fetch(`/api/stories/${e}/pdf`,{headers:t?{Authorization:`Bearer ${t}`}:{}});if(!r.ok)throw new Error("Failed to generate PDF");return r.blob()},async createCheckoutSession(e,t){const r=Array.isArray(e)?e:[e];return await i.post("/api/stripe/create-checkout-session",{storyIds:r,coverType:t||"softcover"})},async createCreditsCheckout(e=100,t=500){return await i.post("/api/stripe/create-credits-checkout",{credits:e,amount:t})},async createPrintOrder(e,t){return await i.post("/api/print-provider/order",{storyId:e,shippingAddress:t})},async getOrderStatus(e){return await i.get(`/api/stripe/order-status/${e}`)}};function ie({currentStep:e=0,onStepClick:t,canAccessStep:r,developerMode:u=!1,onDeveloperModeChange:n}){const g=U(),{t:l,language:a,setLanguage:f}=_(),{isAuthenticated:m,user:c,logout:x,isImpersonating:b}=E(),[y,o]=p.useState(!1),[w,v]=p.useState(!1),[k,P]=p.useState(!1),[h,N]=p.useState(!1),S=p.useRef(null);p.useEffect(()=>{const d=j=>{S.current&&!S.current.contains(j.target)&&o(!1)};return y&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[y]);const O=()=>{x(),o(!1),g("/")},T=(c==null?void 0:c.credits)??0,$=(c==null?void 0:c.credits)===-1;return s.jsxs("nav",{className:"bg-black text-white px-3 py-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsxs("button",{onClick:()=>g("/"),className:"text-sm md:text-base font-bold whitespace-nowrap hover:opacity-80",children:["âœ¨ ",l.title]})}),e>0&&t&&r&&s.jsx("div",{className:"flex items-center gap-0.5 md:gap-1 flex-1 justify-center",children:[1,2,3,4,5].map(d=>{const j=r(d);return s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>j&&t(d),disabled:!j,className:`w-5 h-5 md:w-6 md:h-6 rounded-full flex items-center justify-center text-[10px] md:text-xs font-bold transition-all ${j?e===d?"bg-indigo-600 text-white ring-1 ring-indigo-200":"bg-indigo-500 text-white hover:bg-indigo-600 cursor-pointer hover:scale-110":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:d}),d<5&&s.jsx("div",{className:`w-3 md:w-6 h-0.5 ${j?"bg-indigo-500":"bg-gray-600"}`})]},d)})}),s.jsxs("div",{className:"flex items-center gap-3",children:[m&&((c==null?void 0:c.role)==="admin"||b)&&n&&s.jsxs("button",{onClick:()=>n(!u),className:`px-2 py-1 rounded text-xs font-semibold flex items-center gap-1 transition-colors ${u?"bg-yellow-500 text-black":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,title:a==="de"?"Entwicklermodus":a==="fr"?"Mode dÃ©veloppeur":"Developer Mode",children:[s.jsx(K,{size:14}),s.jsx("span",{className:"hidden md:inline",children:"DEV"})]}),s.jsxs("div",{className:"relative",ref:S,children:[s.jsxs("button",{onClick:()=>o(!y),className:"bg-gray-800 text-white px-3 py-1.5 rounded text-xs font-semibold hover:bg-gray-700 flex items-center gap-2",children:[s.jsx(Z,{size:16}),s.jsx("span",{className:"hidden md:inline",children:"Menu"})]}),y&&s.jsxs("div",{className:"absolute right-0 mt-2 bg-gray-800 rounded-lg shadow-lg overflow-hidden z-50 min-w-[200px]",children:[m&&c&&s.jsxs("div",{className:"border-b border-gray-700 px-4 py-3 bg-gray-900",children:[s.jsxs("div",{className:"text-white font-semibold text-sm mb-1",children:[c.username," ",c.role==="admin"&&"ðŸ‘‘"]}),s.jsxs("div",{className:`text-xs px-2 py-1 rounded inline-block ${$?"bg-purple-600 text-white":T===0?"bg-red-600 text-white":T<50?"bg-yellow-600 text-white":"bg-green-600 text-white"}`,children:[$?"âˆž":T," ",a==="de"?"Credits":a==="fr"?"crÃ©dits":"credits"]})]}),s.jsxs("div",{className:"border-b border-gray-700 px-4 py-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-2",children:a==="de"?"Sprache":a==="fr"?"Langue":"Language"}),s.jsx("div",{className:"flex gap-2",children:["en","de","fr"].map(d=>s.jsx("button",{onClick:()=>{f(d),o(!1)},className:`flex-1 px-3 py-2 rounded text-xs font-semibold ${a===d?"bg-indigo-600 text-white":"bg-gray-700 text-white hover:bg-gray-600"}`,children:d.toUpperCase()},d))})]}),m&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{g("/stories"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(J,{size:16}),s.jsx("span",{children:a==="de"?"Meine Geschichten":a==="fr"?"Mes histoires":"My Stories"})]}),s.jsxs("button",{onClick:()=>{g("/orders"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(W,{size:16}),s.jsx("span",{children:a==="de"?"Meine Bestellungen":a==="fr"?"Mes commandes":"My Orders"})]}),s.jsxs("button",{onClick:()=>{v(!0),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(M,{size:16}),s.jsx("span",{children:a==="de"?"Credits kaufen":a==="fr"?"Acheter des crÃ©dits":"Buy Credits"})]}),((c==null?void 0:c.role)==="admin"||b)&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{g("/admin"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(X,{size:16}),s.jsx("span",{children:a==="de"?"Admin Panel":a==="fr"?"Panneau Admin":"Admin Panel"})]}),s.jsxs("button",{onClick:()=>{g("/admin?tab=users"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(H,{size:16}),s.jsx("span",{children:a==="de"?"Benutzer verwalten":a==="fr"?"GÃ©rer les utilisateurs":"Manage Users"})]})]}),s.jsxs("button",{onClick:()=>{P(!0),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2 border-b border-gray-700",children:[s.jsx(F,{size:16}),s.jsx("span",{children:a==="de"?"Passwort Ã¤ndern":a==="fr"?"Changer le mot de passe":"Change Password"})]}),s.jsxs("button",{onClick:O,className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2",children:[s.jsx(A,{size:16}),s.jsx("span",{children:l.logout})]})]}),!m&&s.jsxs("button",{onClick:()=>{g("/?login=true"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 text-white flex items-center gap-2",children:[s.jsx(A,{size:16}),s.jsx("span",{children:l.login})]})]})]})]})]}),w&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>!h&&v(!1),children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4 shadow-xl",onClick:d=>d.stopPropagation(),children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:a==="de"?"Credits kaufen":a==="fr"?"Acheter des credits":"Buy Credits"}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 mb-6 border-2 border-indigo-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(M,{className:"text-indigo-600",size:24}),s.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"100"}),s.jsx("span",{className:"text-gray-600",children:a==="de"?"Credits":"credits"})]}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"text-3xl font-bold text-indigo-600",children:"CHF 5.-"})})]}),s.jsx("p",{className:"text-sm text-gray-500",children:a==="de"?"100 Credits reichen fuer etwa 3-4 Geschichten":a==="fr"?"100 credits suffisent pour environ 3-4 histoires":"100 credits are enough for about 3-4 stories"})]}),s.jsx("p",{className:"text-sm text-gray-500 mb-4 text-center",children:a==="de"?"Sichere Zahlung mit Stripe":a==="fr"?"Paiement securise avec Stripe":"Secure payment with Stripe"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>v(!1),disabled:h,className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-300 font-semibold disabled:opacity-50",children:a==="de"?"Abbrechen":a==="fr"?"Annuler":"Cancel"}),s.jsx("button",{onClick:async()=>{N(!0);try{const{url:d}=await se.createCreditsCheckout(100,500);d&&(window.location.href=d)}catch(d){console.error("Failed to create checkout:",d),alert(a==="de"?"Fehler beim Erstellen der Zahlung. Bitte versuchen Sie es erneut.":a==="fr"?"Erreur lors de la creation du paiement. Veuillez reessayer.":"Failed to create payment. Please try again."),N(!1)}},disabled:h,className:"flex-1 bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 font-semibold disabled:opacity-50 flex items-center justify-center gap-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx(G,{size:18,className:"animate-spin"}),a==="de"?"Wird geladen...":a==="fr"?"Chargement...":"Loading..."]}):s.jsx(s.Fragment,{children:a==="de"?"Jetzt kaufen":a==="fr"?"Acheter maintenant":"Buy Now"})})]})]})}),s.jsx(ee,{isOpen:k,onClose:()=>P(!1)})]})}const te=p.forwardRef(({label:e,error:t,helperText:r,className:u="",...n},g)=>s.jsxs("div",{className:"w-full",children:[e&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e,n.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsx("textarea",{ref:g,className:`
            w-full px-4 py-2 rounded-lg border resize-y
            transition-all duration-200
            focus:outline-none focus:ring-2
            ${t?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-purple-500 focus:border-purple-500"}
            disabled:bg-gray-100 disabled:cursor-not-allowed
            ${u}
          `,...n}),t&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]}));te.displayName="Textarea";export{Q as A,F as K,ie as N,W as P,se as s};
