import{j as e,u as z,a as Ve,L as Ne}from"./index-CRz74IAy.js";import{b as h,u as qe}from"./vendor-react-BhxjzHy9.js";import{c as A,I as Ye,B as ne,a as Qe,U as _}from"./Input-UbjiDIbZ.js";import{T as Ze,N as Xe,A as et,S as E}from"./Textarea-Cn1uTfKA.js";import{P as tt,T as st,L as at,D as rt,F as we,a as ae,A as nt}from"./api-DD5I4GJa.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=A("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=A("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=A("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=A("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=A("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=A("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=A("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),Ce={sm:"h-1",md:"h-2",lg:"h-3"},mt={default:"bg-purple-600",success:"bg-green-500",warning:"bg-yellow-500",gradient:"bg-gradient-to-r from-purple-600 to-pink-600"};function ut({value:t,max:n=100,label:l,showPercentage:m=!1,size:r="md",variant:y="gradient",className:d=""}){const c=Math.min(Math.max(t/n*100,0),100);return e.jsxs("div",{className:d,children:[(l||m)&&e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l&&e.jsx("span",{className:"text-sm font-medium text-gray-700",children:l}),m&&e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(c),"%"]})]}),e.jsx("div",{className:`w-full bg-gray-200 rounded-full overflow-hidden ${Ce[r]}`,children:e.jsx("div",{className:`${Ce[r]} ${mt[y]} rounded-full transition-all duration-500 ease-out`,style:{width:`${c}%`}})})]})}const xt=[{id:"christmas",name:{en:"Christmas Story",de:`Weihnachts-
Geschichte`,fr:"Histoire de NoÃ«l"},emoji:"ðŸŽ„"},{id:"newyear",name:{en:"New Year Story",de:`Neujahrs-
Geschichte`,fr:"Histoire du Nouvel An"},emoji:"ðŸŽ†"},{id:"pirate",name:{en:"Pirate Adventure",de:"Piraten-Abenteuer",fr:"Aventure de Pirates"},emoji:"ðŸ´â€â˜ ï¸"},{id:"cowboy",name:{en:"Wild West",de:"Wilder Westen",fr:"Far West"},emoji:"ðŸ¤ "},{id:"fireman",name:{en:"Brave Firefighter",de:"Tapferer Feuerwehrmann",fr:"Pompier Courageux"},emoji:"ðŸš’"},{id:"unicorn",name:{en:"Magical Unicorn",de:"Magisches Einhorn",fr:"Licorne Magique"},emoji:"ðŸ¦„"},{id:"ninja",name:{en:"Secret Ninja",de:"Geheimer Ninja",fr:"Ninja Secret"},emoji:"ðŸ¥·"},{id:"space",name:{en:"Space Explorer",de:"Weltraum-Entdecker",fr:"Explorateur Spatial"},emoji:"ðŸš€"},{id:"dinosaur",name:{en:"Dinosaur World",de:"Dinosaurier-Welt",fr:"Monde des Dinosaures"},emoji:"ðŸ¦–"},{id:"princess",name:{en:"Princess Story",de:"Prinzessinnen-Geschichte",fr:"Histoire de Princesse"},emoji:"ðŸ‘‘"},{id:"knight",name:{en:"Knight Adventure",de:"Ritter-Abenteuer",fr:"Aventure de Chevalier"},emoji:"âš”ï¸"},{id:"detective",name:{en:"Detective Mystery",de:"Detektiv-Geheimnis",fr:"MystÃ¨re de DÃ©tective"},emoji:"ðŸ”"}];function ht({selectedType:t,onSelect:n,customTypes:l=[],onAddCustom:m}){const{t:r,language:y}=z(),d=[...xt,...l];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:r.chooseStoryType}),e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-2",children:[d.map(c=>e.jsxs("button",{onClick:()=>n(c.id),className:`p-2 rounded-lg border-2 transition-all ${t===c.id?"border-indigo-600 bg-indigo-50 shadow-lg":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:c.emoji}),e.jsx("div",{className:"font-semibold text-xs",children:c.name[y]})]},c.id)),m&&e.jsxs("button",{onClick:m,className:"p-2 rounded-lg border-2 border-dashed border-indigo-300 hover:border-indigo-600 transition-all hover:bg-indigo-50",children:[e.jsx("div",{className:"text-2xl mb-1",children:e.jsx(K,{size:24,className:"mx-auto text-indigo-600"})}),e.jsx("div",{className:"font-semibold text-xs text-indigo-600",children:r.addCustomStoryType})]})]})]})}const ft=[{id:"pixar",name:{en:"Pixar 3D",de:"Pixar 3D",fr:"Pixar 3D"},emoji:"ðŸŽ¬",image:"/images/Pixar style.jpg",description:{en:"Vibrant, warm Disney/Pixar style 3D animation",de:"Lebendige, warme Disney/Pixar 3D-Animation",fr:"Animation 3D Disney/Pixar vibrante et chaleureuse"},prompt:"pixar style 3d character, vibrant Disney/Pixar 3D animation, warm lighting, child-friendly"},{id:"cartoon",name:{en:"Cartoon",de:"Cartoon",fr:"Dessin animÃ©"},emoji:"ðŸŽ¨",image:"/images/cartoon style.jpg",description:{en:"Classic 2D cartoon style with bold colors",de:"Klassischer 2D-Cartoon-Stil mit krÃ¤ftigen Farben",fr:"Style cartoon 2D classique aux couleurs vives"},prompt:"2D cartoon style, bold outlines, vibrant flat colors, classic animation look"},{id:"anime",name:{en:"Anime",de:"Anime",fr:"Anime"},emoji:"â­",image:"/images/anime style.jpg",description:{en:"Japanese anime style with expressive features",de:"Japanischer Anime-Stil mit ausdrucksstarken Features",fr:"Style anime japonais aux traits expressifs"},prompt:"anime style, Japanese animation, expressive eyes, dynamic poses, cel-shaded"},{id:"chibi",name:{en:"Chibi",de:"Chibi",fr:"Chibi"},emoji:"ðŸŒ¸",image:"/images/chibi style.jpg",description:{en:"Cute chibi style with big heads and small bodies",de:"Niedlicher Chibi-Stil mit groÃŸen KÃ¶pfen und kleinen KÃ¶rpern",fr:"Style chibi mignon avec grandes tÃªtes et petits corps"},prompt:"chibi style, super deformed, cute, big head, small body, kawaii, adorable"},{id:"steampunk",name:{en:"Steampunk",de:"Steampunk",fr:"Steampunk"},emoji:"âš™ï¸",image:"/images/steampunk.jpg",description:{en:"Victorian-era inspired with gears and brass",de:"Von der viktorianischen Ã„ra inspiriert mit ZahnrÃ¤dern und Messing",fr:"InspirÃ© de l'Ã¨re victorienne avec engrenages et laiton"},prompt:"steampunk style, Victorian era, gears, brass, copper, goggles, mechanical details, vintage technology"},{id:"comic",name:{en:"Comic Book",de:"Comic",fr:"Bande dessinÃ©e"},emoji:"ðŸ’¥",image:"/images/comic book style.jpg",description:{en:"Comic book style with bold lines and halftone",de:"Comic-Stil mit krÃ¤ftigen Linien und Raster",fr:"Style bande dessinÃ©e avec lignes Ã©paisses et trames"},prompt:"comic book style, bold ink lines, halftone dots, dynamic action, speech bubbles aesthetic, superhero comic art"},{id:"manga",name:{en:"Manga",de:"Manga",fr:"Manga"},emoji:"ðŸ“š",image:"/images/manga style.jpg",description:{en:"Japanese manga style, black and white with screentones",de:"Japanischer Manga-Stil, schwarz-weiÃŸ mit Rastern",fr:"Style manga japonais, noir et blanc avec trames"},prompt:"manga style, Japanese comic art, detailed linework, screentones, dramatic shading, expressive characters"}];function pt({selectedStyle:t,onSelect:n}){const{t:l,language:m}=z();return e.jsxs("div",{id:"art-style-section",className:"md:bg-indigo-50 md:border-2 md:border-indigo-200 md:rounded-lg md:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ot,{size:18,className:"text-indigo-600"}),e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-800",children:l.chooseArtStyle})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-2 md:mb-3",children:l.artStyleDescription}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 gap-2",children:ft.map(r=>e.jsxs("button",{onClick:()=>n(r.id),className:`rounded-lg border-2 transition-all overflow-hidden flex flex-col bg-white ${t===r.id?"border-indigo-600 shadow-lg ring-2 ring-indigo-200":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"relative w-full h-32 overflow-hidden",children:e.jsx("img",{src:r.image,alt:r.name[m],className:"w-full h-full object-cover"})}),e.jsx("div",{className:"p-1.5 flex flex-col items-center text-center",children:e.jsx("div",{className:"font-bold text-xs text-gray-800",children:r.name[m]})})]},r.id))})]})}const ie=[{value:{en:"Best Friends with",de:"Beste Freunde mit",fr:"Meilleurs amis avec"},inverse:{en:"Best Friends with",de:"Beste Freunde mit",fr:"Meilleurs amis avec"}},{value:{en:"Friends with",de:"Freunde mit",fr:"Amis avec"},inverse:{en:"Friends with",de:"Freunde mit",fr:"Amis avec"}},{value:{en:"Married to",de:"Verheiratet mit",fr:"MariÃ©(e) Ã "},inverse:{en:"Married to",de:"Verheiratet mit",fr:"MariÃ©(e) Ã "}},{value:{en:"In a relationship with",de:"In einer Beziehung mit",fr:"En relation avec"},inverse:{en:"In a relationship with",de:"In einer Beziehung mit",fr:"En relation avec"}},{value:{en:"Older Sibling of",de:"Ã„lteres Geschwister von",fr:"FrÃ¨re/SÅ“ur aÃ®nÃ©(e) de"},inverse:{en:"Younger Sibling of",de:"JÃ¼ngeres Geschwister von",fr:"FrÃ¨re/SÅ“ur cadet(te) de"}},{value:{en:"Younger Sibling of",de:"JÃ¼ngeres Geschwister von",fr:"FrÃ¨re/SÅ“ur cadet(te) de"},inverse:{en:"Older Sibling of",de:"Ã„lteres Geschwister von",fr:"FrÃ¨re/SÅ“ur aÃ®nÃ©(e) de"}},{value:{en:"Parent of",de:"Elternteil von",fr:"Parent de"},inverse:{en:"Child of",de:"Kind von",fr:"Enfant de"}},{value:{en:"Child of",de:"Kind von",fr:"Enfant de"},inverse:{en:"Parent of",de:"Elternteil von",fr:"Parent de"}},{value:{en:"Rivals with",de:"Rivalen mit",fr:"Rivaux avec"},inverse:{en:"Rivals with",de:"Rivalen mit",fr:"Rivaux avec"}},{value:{en:"Neighbors with",de:"Nachbarn mit",fr:"Voisins avec"},inverse:{en:"Neighbors with",de:"Nachbarn mit",fr:"Voisins avec"}},{value:{en:"Not Known to",de:"Nicht bekannt mit",fr:"Pas connu de"},inverse:{en:"Not Known to",de:"Nicht bekannt mit",fr:"Pas connu de"}}];function ze(t){const n=ie.find(l=>l.value.en==="Not Known to");return n?n.value[t]:"Not Known to"}function Te(t){const n=ie.find(l=>l.value.en==="Not Known to");return n?t===n.value.en||t===n.value.de||t===n.value.fr:!1}function bt({characters:t,relationships:n,relationshipTexts:l,onRelationshipChange:m,onRelationshipTextChange:r,customRelationships:y=[],onAddCustomRelationship:d}){const{t:c,language:u}=z(),b=u,S=[...ie,...y.map(o=>({value:{en:o,de:o,fr:o},inverse:{en:o,de:o,fr:o}}))],k=(o,p,a)=>{if(a==="__CREATE_CUSTOM__"){const j=prompt(u==="de"?"Beziehung eingeben:":u==="fr"?"Entrer la relation:":"Enter relationship:");j&&j.trim()&&(d==null||d(j.trim()),m(o,p,j.trim()))}else m(o,p,a)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(lt,{size:24})," ",c.defineRelationships]}),e.jsx("p",{className:"text-sm text-gray-500",children:c.defineRelationshipsDesc}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:t.map((o,p)=>t.map((a,j)=>{if(p>=j)return null;const i=`${o.id}-${a.id}`,x=n[i],P=!x||Te(x);return e.jsx("div",{className:`rounded-lg p-3 md:p-4 ${P?"bg-white border-red-500 border-[3px]":"bg-blue-50 border-blue-300 border-2"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-3 md:gap-6 max-w-[75%] mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-shrink-0",children:[o.photoUrl&&e.jsx("img",{src:o.photoUrl,alt:o.name,className:"w-14 h-14 md:w-16 md:h-16 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-center max-w-[80px] truncate",children:o.name})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1 min-w-0",children:[e.jsxs("select",{value:x||ze(b),onChange:N=>k(o.id,a.id,N.target.value),className:`w-full max-w-[500px] px-2 py-1.5 border rounded text-sm font-medium text-center ${P?"bg-white border-red-400 border-2":"bg-blue-100 border-blue-400"}`,children:[e.jsxs("option",{value:"__CREATE_CUSTOM__",children:["+ ",b==="de"?"Eigene":b==="fr"?"PersonnalisÃ©":"Custom"]}),S.map((N,C)=>e.jsx("option",{value:N.value[b],children:N.value[b]},C))]}),!P&&e.jsx("input",{type:"text",value:l[i]||"",onChange:N=>r(i,N.target.value),placeholder:b==="de"?"Details...":b==="fr"?"DÃ©tails...":"Details...",className:"w-full max-w-[500px] px-2 py-1 border border-blue-300 rounded text-xs text-center bg-white"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-shrink-0",children:[a.photoUrl&&e.jsx("img",{src:a.photoUrl,alt:a.name,className:"w-14 h-14 md:w-16 md:h-16 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-center max-w-[80px] truncate",children:a.name})]})]})},i)}))})]})}function yt({characters:t,mainCharacters:n,onToggleMainCharacter:l,languageLevel:m,onLanguageLevelChange:r,pages:y,onPagesChange:d,dedication:c,onDedicationChange:u,storyDetails:b,onStoryDetailsChange:S,developerMode:k=!1}){const{t:o,language:p}=z(),a=[{value:"1st-grade",label:o.firstGrade,desc:o.firstGradeDesc,image:"/images/text and image on each page.jpg"},{value:"standard",label:o.standard,desc:o.standardDesc,image:"/images/left page text, right page image.jpg"},{value:"advanced",label:o.advanced,desc:o.advancedDesc,image:"/images/dense text left.jpg"}],j=(i,x=!1)=>{const P=x?" (Test)":"";if(m==="1st-grade")return`${i} ${p==="de"?"Seiten":"pages"}${P}`;const N=i/2,C=i/2;return p==="de"?`${i} Seiten (${N} Text + ${C} Bilder)${P}`:p==="fr"?`${i} pages (${N} texte + ${C} images)${P}`:`${i} pages (${N} text + ${C} images)${P}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(gt,{size:24})," ",o.storySettings]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:o.selectMainCharacters}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:t.map(i=>e.jsx("button",{onClick:()=>l(i.id),className:`p-4 rounded-lg border-2 transition-all text-left ${n.includes(i.id)?"border-indigo-600 bg-indigo-50":"border-gray-200 hover:border-indigo-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[i.photoUrl&&e.jsx("img",{src:i.photoUrl,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-bold text-base flex items-center gap-2",children:[i.name,e.jsx("span",{className:n.includes(i.id)?"inline-block":"hidden",children:e.jsx(ct,{size:16,className:"text-indigo-600"})})]}),e.jsxs("div",{className:"text-sm md:text-base text-gray-500",children:[i.gender==="male"?o.male:i.gender==="female"?o.female:o.other,", ",i.age]})]})]})},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:o.readingLevel}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a.map(i=>e.jsxs("button",{onClick:()=>r(i.value),className:`text-left rounded-lg border-2 transition-all overflow-hidden ${m===i.value?"border-indigo-600 ring-2 ring-indigo-200":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"w-full bg-gray-100 p-2",children:e.jsx("img",{src:i.image,alt:i.label,className:"w-full h-auto object-contain"})}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"font-semibold text-base",children:i.label}),e.jsx("div",{className:"text-sm text-gray-500",children:i.desc})]})]},i.value))})]}),m&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:o.numberOfPages}),e.jsxs("select",{value:y,onChange:i=>d(parseInt(i.target.value)),className:"w-full px-4 py-3 border-2 border-indigo-200 rounded-lg focus:border-indigo-600 focus:outline-none text-base md:text-lg font-semibold",children:[k&&e.jsx("option",{value:"10",children:j(10,!0)}),e.jsx("option",{value:"30",children:j(30)}),e.jsx("option",{value:"40",children:j(40)}),e.jsx("option",{value:"50",children:j(50)})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:m==="1st-grade"?p==="de"?"Jede Seite enthÃ¤lt ein Bild mit Text darunter":p==="fr"?"Chaque page contient une image avec du texte en dessous":"Each page contains an image with text below":p==="de"?"Abwechselnd Textseite und Bildseite":p==="fr"?"Alternance de pages de texte et d'images":"Alternating text page and image page"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-gray-800 mb-2",children:o.storyDetails}),e.jsx("textarea",{value:b,onChange:i=>S(i.target.value),placeholder:o.storyDetailsPlaceholder,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-base",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-gray-800 mb-2",children:p==="de"?"Widmung (Optional)":p==="fr"?"DÃ©dicace (Facultatif)":"Dedication (Optional)"}),e.jsx("textarea",{value:c,onChange:i=>u(i.target.value),placeholder:p==="de"?'z.B. "FÃ¼r meine liebe Tochter Emma zum 5. Geburtstag"':p==="fr"?'Par exemple "Pour ma chÃ¨re fille Emma pour son 5Ã¨me anniversaire"':'e.g. "For my dear daughter Emma on her 5th birthday"',className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-base",rows:2,maxLength:200}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:p==="de"?"Dieser Text wird auf Seite 0 Ihres Buches gedruckt. Wenn Sie nichts eingeben, wird Seite 0 nur eine Illustration ohne Text enthalten.":p==="fr"?"Ce texte sera imprimÃ© sur la page 0 de votre livre. Si vous ne saisissez rien, la page 0 ne contiendra qu'une illustration sans texte.":"This text will be printed on page 0 of your book. If you leave it empty, page 0 will contain only an illustration with no text."})]})]})]})}function jt({characters:t,showSuccessMessage:n,onEdit:l,onDelete:m,onCreateAnother:r,onContinue:y}){const{t:d,language:c}=z();return t.length===0?null:e.jsxs("div",{className:"space-y-4",children:[n&&e.jsx("div",{className:"md:bg-green-50 md:border-2 md:border-green-400 md:rounded-xl p-4 animate-fade-in",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center",children:e.jsx(it,{size:20})}),e.jsx("h3",{className:"text-lg font-bold text-green-700",children:c==="de"?"Charakter erfolgreich erstellt!":c==="fr"?"Personnage cre avec succes!":"Character Created Successfully!"})]})}),e.jsxs("div",{className:"bg-white border-2 border-indigo-200 rounded-lg p-3",children:[e.jsx("h3",{className:"text-base font-bold text-gray-800 mb-2",children:d.yourCharacters}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:t.map(u=>e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.photoUrl&&e.jsx("img",{src:u.photoUrl,alt:u.name,className:"w-12 h-12 md:w-16 md:h-16 rounded-full object-cover border-2 border-indigo-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-sm md:text-base truncate",children:u.name}),e.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:[u.gender==="male"?d.male:u.gender==="female"?d.female:d.other,","," ",u.age," ",c==="de"?"J":c==="fr"?"ans":"y"]})]})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>l(u),className:"bg-indigo-600 text-white px-2 md:px-3 py-1 rounded text-xs hover:bg-indigo-700 flex items-center gap-1",children:[e.jsx(tt,{size:12}),d.editCharacter]}),e.jsxs("button",{onClick:()=>m(u.id),className:"bg-red-500 text-white px-2 md:px-3 py-1 rounded text-xs hover:bg-red-600 flex items-center gap-1",children:[e.jsx(st,{size:12}),d.deleteCharacter]})]})]}),u.strengths&&u.strengths.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-green-600",children:[d.strengths,":"]})," ",u.strengths.join(", ")]}),u.weaknesses&&u.weaknesses.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-orange-600",children:[d.weaknesses,":"]})," ",u.weaknesses.join(", ")]}),u.fears&&u.fears.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-red-600",children:[d.fears,":"]})," ",u.fears.join(", ")]})]},u.id))})]}),e.jsxs("div",{className:"md:bg-indigo-50 md:border-2 md:border-indigo-200 md:rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-800 mb-4 text-center font-semibold",children:c==="de"?"Was mochten Sie als Nachstes tun?":c==="fr"?"Que voulez-vous faire ensuite?":"What would you like to do next?"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsx("button",{onClick:r,className:"bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 font-semibold flex items-center justify-center gap-2 transition-colors",children:c==="de"?"Weiteren Charakter erstellen":c==="fr"?"Creer un autre personnage":"Create Another Character"}),e.jsx("button",{onClick:y,className:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-semibold flex items-center justify-center gap-2 transition-colors",children:c==="de"?"Weiter zu Beziehungen":c==="fr"?"Continuer vers les relations":"Continue to Relationships"})]})]})]})}const vt={success:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"},warning:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"},danger:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"}};function re({label:t,traits:n,selectedTraits:l,onSelect:m,minRequired:r=0,variant:y="success",allowCustom:d=!0}){const{t:c,language:u}=z(),[b,S]=h.useState(""),[k,o]=h.useState([]),p=vt[y],a=x=>{l.includes(x)?m(l.filter(P=>P!==x)):m([...l,x])},j=()=>{if(b.trim()&&!l.includes(b.trim())){const x=b.trim();o([...k,x]),m([...l,x]),S("")}},i=[...n,...k];return e.jsxs("div",{className:`border ${p.border} rounded-lg p-3 ${p.bg.replace("100","50")}`,children:[e.jsxs("label",{className:`block text-sm font-semibold mb-2 ${p.text}`,children:[t," ",r>0&&e.jsxs("span",{className:"text-xs font-normal",children:["(",c.selectAtLeast," ",r,")"]}),l.length>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(",c.selected,": ",l.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:i.map(x=>e.jsx("button",{onClick:()=>a(x),className:`px-2 py-1 rounded text-xs transition-colors ${l.includes(x)?p.selected:`${p.bg} ${p.hover} text-gray-700`}`,children:x},x))}),d&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",value:b,onChange:x=>S(x.target.value),onKeyDown:x=>x.key==="Enter"&&j(),placeholder:u==="de"?"Eigene hinzufugen...":u==="fr"?"Ajouter personnalise...":"Add custom...",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"}),e.jsxs("button",{onClick:j,disabled:!b.trim(),className:`px-2 py-1 rounded text-xs font-semibold flex items-center gap-1 ${b.trim()?`${p.selected.split(" ")[0]} text-white hover:opacity-90`:"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(K,{size:12}),u==="de"?"Hinzufugen":u==="fr"?"Ajouter":"Add"]})]})]})}const Nt={en:["Brave","Smart","Kind","Strong","Fast","Creative","Funny","Leader","Helpful","Patient","Honest","Loyal","Curious","Determined","Caring","Confident","Cheerful","Generous","Clever","Adventurous","Resourceful","Protective","Imaginative","Hardworking","Trustworthy"],de:["Mutig","Klug","Freundlich","Stark","Schnell","Kreativ","Lustig","FÃ¼hrungspersÃ¶nlichkeit","Hilfsbereit","Geduldig","Ehrlich","Treu","Neugierig","Entschlossen","FÃ¼rsorglich","Selbstbewusst","FrÃ¶hlich","GroÃŸzÃ¼gig","Schlau","Abenteuerlustig","Einfallsreich","BeschÃ¼tzend","Fantasievoll","FleiÃŸig","VertrauenswÃ¼rdig"],fr:["Courageux","Intelligent","Gentil","Fort","Rapide","CrÃ©atif","DrÃ´le","Leader","Serviable","Patient","HonnÃªte","Loyal","Curieux","DÃ©terminÃ©","AttentionnÃ©","Confiant","Joyeux","GÃ©nÃ©reux","Astucieux","Aventureux","DÃ©brouillard","Protecteur","Imaginatif","Travailleur","Digne de confiance"]},wt={en:["Shy","Clumsy","Impatient","Forgetful","Messy","Talkative","Stubborn","Lazy","Greedy","Jealous","Anxious","Distracted","Reckless","Bossy","Easily scared","Too trusting","Perfectionist","Indecisive","Secretive","Boastful","Quick-tempered","Careless","Overly cautious","Selfish"],de:["SchÃ¼chtern","Tollpatschig","Ungeduldig","Vergesslich","Unordentlich","GesprÃ¤chig","Stur","Faul","Gierig","EifersÃ¼chtig","Ã„ngstlich","Abgelenkt","Leichtsinnig","HerrschsÃ¼chtig","Leicht Ã¤ngstlich","Zu vertrauensvoll","Perfektionist","Unentschlossen","Verschlossen","Prahlerisch","JÃ¤hzornig","NachlÃ¤ssig","Ãœbervorsichtig","Egoistisch"],fr:["Timide","Maladroit","Impatient","Distrait","DÃ©sordonnÃ©","Bavard","TÃªtu","Paresseux","Avide","Jaloux","Anxieux","Distrait","Imprudent","Autoritaire","Facilement effrayÃ©","Trop confiant","Perfectionniste","IndÃ©cis","Secret","Vantard","ColÃ©rique","NÃ©gligent","Trop prudent","Ã‰goÃ¯ste"]},St={en:["Fear of heights","Fear of spiders","Fear of the dark","Fear of being alone","Fear of loud noises"],de:["HÃ¶henangst","Angst vor Spinnen","Angst vor der Dunkelheit","Angst allein zu sein","Angst vor lauten GerÃ¤uschen"],fr:["Peur du vide","Peur des araignÃ©es","Peur du noir","Peur d'Ãªtre seul","Peur des bruits forts"]},ke=Nt,Pe=wt,De=St;function Ct({character:t,onChange:n,onSave:l,onCancel:m,onPhotoChange:r,isLoading:y}){const{t:d,language:c}=z(),u=a=>{var i;const j=(i=a.target.files)==null?void 0:i[0];j&&r(j)},b=(a,j)=>{n({...t,[a]:j})},S=t.name&&t.strengths&&t.strengths.length>=3&&t.weaknesses&&t.weaknesses.length>=2,k=ke[c]||ke.en,o=Pe[c]||Pe.en,p=De[c]||De.en;return e.jsxs("div",{className:"bg-white border-2 border-indigo-200 rounded-lg p-3 space-y-3",children:[e.jsx("h3",{className:"text-base font-bold text-gray-800",children:t.id?d.editCharacter:d.startCreating}),e.jsx(Ye,{label:`${d.characterName} *`,value:t.name,onChange:a=>b("name",a.target.value),placeholder:d.characterName}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"md:border md:border-indigo-300 md:rounded-lg p-2 md:bg-indigo-50",children:[e.jsx("label",{className:"block text-xs font-semibold mb-2 text-center",children:d.characterPhoto}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.photoUrl&&e.jsx("img",{src:t.photoUrl,alt:"Character",className:"w-20 h-20 rounded-full object-cover border-2 border-indigo-400"}),e.jsxs("label",{className:"cursor-pointer bg-indigo-600 text-white px-3 py-1.5 rounded text-xs hover:bg-indigo-700 flex items-center gap-1 font-semibold transition-colors",children:[e.jsx(Fe,{size:14})," ",d.uploadPhoto,e.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"hidden"})]})]})]}),e.jsxs("div",{className:"md:border md:border-indigo-300 md:rounded-lg p-4 md:bg-indigo-50",children:[e.jsx("label",{className:"block text-xs font-semibold mb-3 text-center",children:c==="de"?"Eigenschaften":c==="fr"?"CaractÃ©ristiques":"Attributes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap min-w-[60px]",children:[d.gender,":"]}),e.jsxs("select",{value:t.gender,onChange:a=>b("gender",a.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded text-sm",children:[e.jsx("option",{value:"male",children:d.male}),e.jsx("option",{value:"female",children:d.female}),e.jsx("option",{value:"other",children:d.other})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap",children:[d.age,":"]}),e.jsx("input",{type:"number",value:t.age,onChange:a=>b("age",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",min:"1",max:"120"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap",children:[c==="de"?"Grosse":c==="fr"?"Taille":"Height",":"]}),e.jsx("input",{type:"text",value:t.height||"",onChange:a=>b("height",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",placeholder:"cm"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap min-w-[60px]",children:[d.hairColor,":"]}),e.jsx("input",{type:"text",value:t.hairColor||"",onChange:a=>b("hairColor",a.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded text-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-semibold block mb-1",children:[d.otherFeatures,":"]}),e.jsx("input",{type:"text",value:t.otherFeatures||"",onChange:a=>b("otherFeatures",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",placeholder:d.descriptionPlaceholder})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(re,{label:d.strengths,traits:k,selectedTraits:t.strengths||[],onSelect:a=>b("strengths",a),minRequired:3,variant:"success"}),e.jsx(re,{label:d.weaknesses,traits:o,selectedTraits:t.weaknesses||[],onSelect:a=>b("weaknesses",a),minRequired:2,variant:"warning"}),e.jsx(re,{label:d.fears,traits:p,selectedTraits:t.fears||[],onSelect:a=>b("fears",a),variant:"danger"})]}),e.jsx(Ze,{label:d.specialDetails,value:t.specialDetails||"",onChange:a=>b("specialDetails",a.target.value),placeholder:d.specialDetailsPlaceholder,rows:3}),e.jsxs("div",{className:"flex gap-3",children:[m&&e.jsx("button",{onClick:m,className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:d.cancel}),e.jsx(ne,{onClick:l,disabled:!S||y,loading:y,icon:dt,className:m?"flex-1":"w-full",children:d.saveCharacter})]}),!S&&e.jsx("p",{className:"text-xs text-red-500 text-center",children:c==="de"?"Bitte Name eingeben, mind. 3 Starken und 2 Schwachen wahlen":c==="fr"?"Veuillez entrer un nom, selectionner au moins 3 forces et 2 faiblesses":"Please enter a name, select at least 3 strengths and 2 weaknesses"})]})}function kt({onPhotoSelect:t,showExamples:n=!0}){const{t:l,language:m}=z(),r=y=>{var c;const d=(c=y.target.files)==null?void 0:c[0];d&&t(d)};return e.jsxs("div",{className:"bg-indigo-50 border-2 border-indigo-300 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-indigo-700 mb-4 text-center",children:l.uploadPhotoFirst}),e.jsx("div",{className:"text-center mb-5",children:e.jsxs("label",{className:"cursor-pointer inline-flex items-center justify-center gap-3 bg-indigo-600 text-white px-10 py-4 rounded-xl text-xl hover:bg-indigo-700 font-bold shadow-lg transition-colors",children:[e.jsx(Fe,{size:28})," ",l.uploadPhoto,e.jsx("input",{type:"file",accept:"image/*",onChange:r,className:"hidden"})]})}),n&&e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/Full body.jpg",alt:"Full body example",className:"w-full md:max-h-32 object-contain rounded border-2 border-green-400 mb-1"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["âœ“ ",m==="de"?"GanzkÃ¶rper":m==="fr"?"Corps entier":"Full body"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/Upper body.jpg",alt:"Upper body example",className:"w-full md:max-h-32 object-contain rounded border-2 border-green-400 mb-1"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["âœ“ ",m==="de"?"OberkÃ¶rper":m==="fr"?"Buste":"Upper body"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/No zoomed in close up.jpg",alt:"Too close example",className:"w-full md:max-h-32 object-contain rounded border-2 border-red-400 mb-1"}),e.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["âœ— ",m==="de"?"Nahaufnahme/Unscharf":m==="fr"?"Gros plan/Flou":"Close-up/Blurry"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/No sunglasses, hat or helmets.jpg",alt:"No accessories example",className:"w-full md:max-h-32 object-contain rounded border-2 border-red-400 mb-1"}),e.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["âœ— ",m==="de"?"Brille/Hut/Helm":m==="fr"?"Lunettes/Chapeau":"Glasses/Hat/Helmet"]})]})]})})]})}function Pt({current:t,total:n,message:l,isGenerating:m=!0}){const{language:r}=z();return!m||n===0?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8 text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(at,{size:48,className:"animate-spin text-indigo-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:r==="de"?"Generiere Geschichte...":r==="fr"?"Generation en cours...":"Generating Story..."})]}),e.jsx(ut,{value:t,max:n,showPercentage:!0,size:"lg",className:"mb-4"}),l&&e.jsx("p",{className:"text-gray-600 text-sm",children:l}),e.jsx("p",{className:"text-gray-400 text-xs mt-4",children:r==="de"?"Bitte warten Sie, dies kann einige Minuten dauern...":r==="fr"?"Veuillez patienter, cela peut prendre quelques minutes...":"Please wait, this may take a few minutes..."})]})})}function Dt({title:t,story:n,sceneImages:l,languageLevel:m="standard",isGenerating:r=!1,onDownloadPdf:y,onBuyBook:d,onCreateAnother:c,onDownloadTxt:u,storyId:b,developerMode:S=!1}){const{t:k,language:o}=z(),p=m==="1st-grade",j=(x=>x?x.split(/(?:---\s*(?:Page|Seite)\s+\d+\s*---|##\s*(?:Page|Seite)\s+\d+)/i).slice(1).filter(N=>N.trim().length>0):[])(n),i=l.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center flex-wrap gap-3",children:e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Qe,{size:24})," ",k.yourStory]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[S&&u&&e.jsxs("button",{onClick:u,className:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-semibold flex items-center justify-center gap-2",children:[e.jsx(rt,{size:20})," ",k.downloadTXT]}),i&&y&&e.jsxs("button",{onClick:y,disabled:r,className:`bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-green-600"}`,children:[e.jsx(we,{size:20})," ",o==="de"?"PDF herunterladen":o==="fr"?"TÃ©lÃ©charger PDF":"Download PDF"]}),i&&b&&d&&e.jsxs("button",{onClick:d,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(Se,{size:20})," ",o==="de"?"Buch kaufen (CHF 36)":o==="fr"?"Acheter le livre (CHF 36)":"Buy Book (CHF 36)"]}),c&&e.jsxs("button",{onClick:c,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 sm:col-span-2 lg:col-span-1 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(K,{size:20})," ",k.createAnotherStory]})]}),i&&n&&e.jsxs("div",{className:"space-y-8 mt-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 text-center mb-6",children:t||(o==="de"?"Ihre Geschichte":o==="fr"?"Votre histoire":"Your Story")}),j.map((x,P)=>{const N=P+1,C=l.find(M=>M.pageNumber===N);return e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:o==="de"?`Seite ${N}`:o==="fr"?`Page ${N}`:`Page ${N}`}),p?e.jsxs("div",{className:"flex flex-col items-center max-w-2xl mx-auto",children:[C&&C.imageData?e.jsx("div",{className:"w-full mb-4",children:e.jsx("img",{src:C.imageData,alt:`Scene for page ${N}`,className:"w-full rounded-lg shadow-md object-cover"})}):e.jsx("div",{className:"w-full flex items-center justify-center bg-gray-100 rounded-lg p-8 mb-4",children:e.jsx("p",{className:"text-gray-500 text-center",children:o==="de"?"Kein Bild fÃ¼r diese Seite":o==="fr"?"Pas d'image pour cette page":"No image for this page"})}),e.jsx("div",{className:"w-full bg-indigo-50 rounded-lg p-6 border-2 border-indigo-200",children:e.jsx("p",{className:"text-gray-800 leading-relaxed whitespace-pre-wrap font-serif text-xl text-center",children:x.trim()})})]}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[C&&C.imageData?e.jsx("div",{className:"flex flex-col",children:e.jsx("img",{src:C.imageData,alt:`Scene for page ${N}`,className:"w-full rounded-lg shadow-md object-cover"})}):e.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-lg p-8",children:e.jsx("p",{className:"text-gray-500 text-center",children:o==="de"?"Kein Bild fÃ¼r diese Seite":o==="fr"?"Pas d'image pour cette page":"No image for this page"})}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{className:"text-gray-800 leading-relaxed whitespace-pre-wrap font-serif text-xl",children:x.trim()})})})]})]},N)})]}),i&&n&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-xl p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4 text-center",children:o==="de"?"Was mÃ¶chten Sie als NÃ¤chstes tun?":o==="fr"?"Que souhaitez-vous faire ensuite ?":"What would you like to do next?"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[y&&e.jsxs("button",{onClick:y,disabled:r,className:`bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-green-600"}`,children:[e.jsx(we,{size:20})," ",o==="de"?"PDF herunterladen":o==="fr"?"TÃ©lÃ©charger PDF":"Download PDF"]}),b&&d&&e.jsxs("button",{onClick:d,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(Se,{size:20})," ",o==="de"?"Buch kaufen (CHF 36)":o==="fr"?"Acheter le livre (CHF 36)":"Buy Book (CHF 36)"]}),c&&e.jsxs("button",{onClick:c,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(K,{size:20})," ",k.createAnotherStory]})]})]})]})}function Ft(t){return{id:t.id,name:t.name,gender:t.gender,age:t.age,height:t.height,build:t.build,hairColor:t.hair_color,otherFeatures:t.other_features,clothing:t.clothing,specialDetails:t.special_details,strengths:t.strengths||[],weaknesses:t.weaknesses||[],fears:t.fears||[],photoUrl:t.photo_url,bodyPhotoUrl:t.body_photo_url,bodyNoBgUrl:t.body_no_bg_url,faceBox:t.face_box,bodyBox:t.body_box}}function zt(t){return{id:t.id,name:t.name,gender:t.gender,age:t.age,height:t.height,build:t.build,hair_color:t.hairColor,other_features:t.otherFeatures,clothing:t.clothing,special_details:t.specialDetails,strengths:t.strengths,weaknesses:t.weaknesses,fears:t.fears,photo_url:t.photoUrl,body_photo_url:t.bodyPhotoUrl,body_no_bg_url:t.bodyNoBgUrl,face_box:t.faceBox,body_box:t.bodyBox}}const O={async getCharacters(){return((await ae.get("/api/characters")).characters||[]).map(Ft)},async saveCharacters(t){await ae.post("/api/characters",{characters:t.map(zt)})},async analyzePhoto(t){try{const n=await ae.post("/api/analyze-photo",{imageData:t});return{success:n.success,faceThumbnail:n.faceThumbnail,bodyCrop:n.bodyCrop,bodyNoBg:n.bodyNoBg,faceBox:n.faceBox,bodyBox:n.bodyBox,attributes:n.attributes?{age:n.attributes.age,gender:n.attributes.gender,height:n.attributes.height,build:n.attributes.build,hairColor:n.attributes.hair_color,clothing:n.attributes.clothing}:void 0}}catch(n){return console.error("Photo analysis failed:",n),{success:!1}}}};function Et(){const t=qe(),{t:n,language:l}=z(),{isAuthenticated:m}=Ve(),[r,y]=h.useState(1),[d,c]=h.useState(!1),[u,b]=h.useState(!1),[S,k]=h.useState(""),[o,p]=h.useState("pixar"),[a,j]=h.useState([]),[i,x]=h.useState(null),[P,N]=h.useState(!1),[C,M]=h.useState(()=>{try{const s=localStorage.getItem("story_relationships");return s?JSON.parse(s):{}}catch{return{}}}),[I,Ae]=h.useState(()=>{try{const s=localStorage.getItem("story_relationship_texts");return s?JSON.parse(s):{}}catch{return{}}}),[U,$e]=h.useState(()=>{try{const s=localStorage.getItem("story_custom_relationships");return s?JSON.parse(s):[]}catch{return[]}}),W=h.useRef(null),[B,R]=h.useState(()=>{try{const s=localStorage.getItem("story_main_characters");return s?JSON.parse(s):[]}catch{return[]}}),[L,Be]=h.useState(()=>{try{return localStorage.getItem("story_language_level")||"standard"}catch{return"standard"}}),[J,_e]=h.useState(()=>{try{const s=localStorage.getItem("story_pages");return s?parseInt(s):30}catch{return 30}}),[V,Ee]=h.useState(()=>localStorage.getItem("story_dedication")||""),[q,Me]=h.useState(()=>localStorage.getItem("story_details")||""),[Y,le]=h.useState(!1),[Q,G]=h.useState({current:0,total:0,message:""}),[oe,de]=h.useState(""),[H,ce]=h.useState(""),[,ge]=h.useState([]),[Ie]=h.useState([]);h.useEffect(()=>{m||t("/")},[m,t]);const me=s=>{if(s.length===0)return;const g=s.filter(f=>{const v=parseInt(f.age);return v>=1&&v<=10});if(g.length>0){const f=g.map(v=>v.id);R(f),console.log(`Auto-selected ${g.length} main character(s) aged 1-10`)}else{const f=s.reduce((v,T)=>{const w=parseInt(T.age)||999,F=parseInt(v.age)||999;return w<F?T:v});R([f.id]),console.log(`Auto-selected youngest character as main: ${f.name} (age ${f.age})`)}};h.useEffect(()=>{m&&(async()=>{try{c(!0);const g=await O.getCharacters();j(g),g.length>0&&me(g)}catch(g){console.error("Failed to load characters:",g)}finally{c(!1)}})()},[m]),h.useEffect(()=>{r===2&&a.length===0&&!i&&!d&&Z()},[r,a.length,i,d]),h.useEffect(()=>{Object.keys(C).length>0&&localStorage.setItem("story_relationships",JSON.stringify(C))},[C]),h.useEffect(()=>{Object.keys(I).length>0&&localStorage.setItem("story_relationship_texts",JSON.stringify(I))},[I]),h.useEffect(()=>{U.length>0&&localStorage.setItem("story_custom_relationships",JSON.stringify(U))},[U]),h.useEffect(()=>{localStorage.setItem("story_main_characters",JSON.stringify(B))},[B]),h.useEffect(()=>{localStorage.setItem("story_language_level",L)},[L]),h.useEffect(()=>{localStorage.setItem("story_pages",J.toString())},[J]),h.useEffect(()=>{localStorage.setItem("story_dedication",V)},[V]),h.useEffect(()=>{localStorage.setItem("story_details",q)},[q]),h.useEffect(()=>{if(r===3&&a.length>=2){const s=a.map(g=>g.id).sort().join("-");if(!W.current||W.current!==s){const g=l;console.log("Initializing relationships for step 3, charKey:",s),M(f=>{const v={...f};let T=!1;return a.forEach((w,F)=>{a.forEach((te,se)=>{if(F<se){const D=`${w.id}-${te.id}`;v[D]||(v[D]=ze(g),T=!0,console.log("Initializing missing relationship:",D))}})}),T?v:f}),W.current=s}}},[r,a,l]);const ue=()=>{if(a.length<2)return!0;for(let s=0;s<a.length;s++)for(let g=s+1;g<a.length;g++){const f=`${a[s].id}-${a[g].id}`,v=C[f];if(!v||Te(v))return!1}return!0},Z=()=>{x({id:Date.now(),name:"",gender:"other",age:"8",strengths:[],weaknesses:[],fears:[]}),N(!1)},xe=async s=>{const g=new FileReader;g.onload=async f=>{var T;const v=(T=f.target)==null?void 0:T.result;try{c(!0);const w=await O.analyzePhoto(v);if(w.success){const F=w.faceThumbnail||v,te=w.bodyCrop||v,se=w.bodyNoBg||void 0;console.log("Photo analysis successful:",{hasFaceThumbnail:!!w.faceThumbnail,hasBodyCrop:!!w.bodyCrop,hasBodyNoBg:!!w.bodyNoBg}),x(D=>{var fe,pe,be,ye,je,ve;return D?{...D,photoUrl:F,bodyPhotoUrl:te,bodyNoBgUrl:se,faceBox:w.faceBox,bodyBox:w.bodyBox,gender:((fe=w.attributes)==null?void 0:fe.gender)||D.gender,age:((pe=w.attributes)==null?void 0:pe.age)||D.age,height:((be=w.attributes)==null?void 0:be.height)||D.height,build:((ye=w.attributes)==null?void 0:ye.build)||D.build,hairColor:((je=w.attributes)==null?void 0:je.hairColor)||D.hairColor,clothing:((ve=w.attributes)==null?void 0:ve.clothing)||D.clothing}:null})}else console.warn("Photo analysis failed, using original photo"),x(F=>F?{...F,photoUrl:v}:null)}catch(w){console.error("Photo analysis error:",w),x(F=>F?{...F,photoUrl:v}:null)}finally{c(!1)}},g.readAsDataURL(s)},Ue=async()=>{if(i){c(!0);try{const g=i.id&&a.find(f=>f.id===i.id)?a.map(f=>f.id===i.id?i:f):[...a,i];console.log("Saving characters:",g),await O.saveCharacters(g),console.log("Characters saved successfully"),j(g),me(g),x(null),N(!0)}catch(s){console.error("Failed to save character:",s),alert("Failed to save character. Please try again.")}finally{c(!1)}}},Re=s=>{x({...s}),N(!1)},Le=async s=>{const g=a.filter(f=>f.id!==s);try{await O.saveCharacters(g),j(g),R(f=>f.filter(v=>v!==s))}catch(f){console.error("Failed to delete character:",f)}},Ge=(s,g,f)=>{const v=`${s}-${g}`;console.log("Updating relationship:",v,"=",f),M(T=>{const w={...T,[v]:f};return console.log("New relationships state:",w),w})},He=s=>{$e(g=>[...g,s])},Oe=s=>{R(g=>g.includes(s)?g.filter(f=>f!==s):[...g,s])},X=s=>{s>=0&&s<=5&&y(s)},Ke=s=>s===1?!0:s===2?S!=="":s===3?S!==""&&a.length>0:s===4?S!==""&&a.length>0&&ue():s===5?H!=="":!1,$=()=>r===1?S!=="":r===2?a.length>0:r===3?ue():r===4?B.length>0:!1,he=()=>{r<4&&$()&&X(r+1)},We=()=>{r>0&&X(r-1)},ee=async()=>{le(!0),y(5),G({current:1,total:4,message:l==="de"?"Erstelle Gliederung...":l==="fr"?"Creation du plan...":"Generating outline..."});try{await new Promise(g=>setTimeout(g,1500)),G({current:2,total:4,message:l==="de"?"Schreibe Geschichte...":l==="fr"?"Ecriture de l'histoire...":"Writing story..."}),await new Promise(g=>setTimeout(g,1500)),G({current:3,total:4,message:l==="de"?"Erstelle Szenen...":l==="fr"?"Creation des scenes...":"Creating scenes..."}),await new Promise(g=>setTimeout(g,1500));const s=a.find(g=>B.includes(g.id));de(s?`${s.name}'s Adventure`:"My Magical Story"),ce(`--- Page 1 ---
Once upon a time, ${(s==null?void 0:s.name)||"our hero"} set off on a magical adventure.

--- Page 2 ---
The journey was full of wonder and excitement.

--- Page 3 ---
And they all lived happily ever after.`),ge([{pageNumber:1,description:"A magical forest at dawn with golden sunlight filtering through the trees"},{pageNumber:2,description:"The hero discovering a hidden treasure in a mysterious cave"},{pageNumber:3,description:"A joyful celebration with friends under a rainbow"}]),G({current:4,total:4,message:l==="de"?"Fertig!":l==="fr"?"Termine!":"Complete!"})}catch(s){console.error("Generation failed:",s)}finally{setTimeout(()=>le(!1),500)}},Je=()=>{switch(r){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ht,{selectedType:S,onSelect:s=>{k(s),setTimeout(()=>{const g=document.getElementById("art-style-section");g&&g.scrollIntoView({behavior:"smooth",block:"start"})},100)}}),S&&e.jsx(pt,{selectedStyle:o,onSelect:p})]});case 2:return i?i.photoUrl?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(_,{size:24})," ",n.createCharacters]}),e.jsx(Ct,{character:i,onChange:x,onSave:Ue,onCancel:()=>x(null),onPhotoChange:xe,isLoading:d})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(_,{size:24})," ",n.createCharacters]}),e.jsx(kt,{onPhotoSelect:xe}),e.jsx("button",{onClick:()=>x(null),className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:n.cancel})]}):a.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(_,{size:24})," ",n.createCharacters]}),e.jsx(jt,{characters:a,showSuccessMessage:P,onEdit:Re,onDelete:Le,onCreateAnother:Z,onContinue:he})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(_,{size:24})," ",n.createCharacters]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.startCreating}),e.jsx(ne,{onClick:Z,icon:E,children:l==="de"?"Ersten Charakter erstellen":l==="fr"?"Creer le premier personnage":"Create First Character"})]})]});case 3:return e.jsx(bt,{characters:a,relationships:C,relationshipTexts:I,onRelationshipChange:Ge,onRelationshipTextChange:(s,g)=>Ae(f=>({...f,[s]:g})),customRelationships:U,onAddCustomRelationship:He});case 4:return e.jsx(yt,{characters:a,mainCharacters:B,onToggleMainCharacter:Oe,languageLevel:L,onLanguageLevelChange:Be,pages:J,onPagesChange:_e,dedication:V,onDedicationChange:Ee,storyDetails:q,onStoryDetailsChange:Me,developerMode:u});case 5:return H?e.jsx(Dt,{title:oe,story:H,sceneImages:Ie,languageLevel:L,isGenerating:Y,developerMode:u,onDownloadTxt:()=>{const s=new Blob([H],{type:"text/plain"}),g=URL.createObjectURL(s),f=document.createElement("a");f.href=g,f.download=`${oe}.txt`,f.click(),URL.revokeObjectURL(g)},onCreateAnother:()=>{ce(""),de(""),ge([]),y(1)}}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:n.generateStory}),e.jsx("p",{className:"text-gray-600 mb-6",children:l==="de"?"Bereit, deine Geschichte zu erstellen!":l==="fr"?"PrÃªt Ã  crÃ©er votre histoire!":"Ready to create your story!"}),e.jsx(ne,{onClick:ee,size:"lg",icon:E,children:n.generateStory})]});default:return null}};return m?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Xe,{currentStep:r,onStepClick:X,canAccessStep:Ke,developerMode:u,onDeveloperModeChange:b}),e.jsx("div",{className:"max-w-7xl mx-auto px-3 md:px-8 mt-2 md:mt-8 flex-1",children:e.jsxs("div",{className:"md:bg-white md:rounded-2xl md:shadow-xl md:p-8",children:[d&&!Y?e.jsx("div",{className:"py-12",children:e.jsx(Ne,{message:l==="de"?"Laden...":l==="fr"?"Chargement...":"Loading..."})}):Je(),r<5&&!i&&e.jsxs("div",{className:`mt-6 pt-6 border-t border-gray-200 ${r===4?"space-y-4":"flex justify-between"}`,children:[e.jsxs("button",{onClick:We,className:"bg-transparent text-gray-800 hover:bg-gray-100 px-6 py-3 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(nt,{size:20})," ",n.back]}),r!==4&&e.jsxs("button",{onClick:he,disabled:!$(),className:`px-6 py-3 rounded-lg font-semibold flex items-center gap-2 ${$()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[n.next," ",e.jsx(et,{size:20})]}),r===4&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:ee,disabled:!$(),className:`w-full py-3 rounded-lg font-bold text-base flex items-center justify-center gap-2 ${$()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-400 text-white cursor-not-allowed"}`,children:[e.jsx(E,{size:20})," ",n.generateStory]}),u&&e.jsxs("button",{onClick:ee,disabled:!$(),className:`w-full py-3 rounded-lg font-bold text-base flex items-center justify-center gap-2 ${$()?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-gray-400 text-white cursor-not-allowed"}`,children:[e.jsx(E,{size:20}),l==="de"?"Nur Text generieren (ohne Bilder)":l==="fr"?"GÃ©nÃ©rer le texte uniquement (sans images)":"Generate Text Only (no images)"]})]})]})]})}),Y&&e.jsx(Pt,{current:Q.current,total:Q.total,message:Q.message})]}):e.jsx(Ne,{fullScreen:!0})}export{Et as default};
