import{j as e,u as z,a as Ze,L as Se}from"./index-BTklDQS8.js";import{b as p,u as Xe}from"./vendor-react-BhxjzHy9.js";import{c as A,I as et,B as ie,a as tt,U as E}from"./Input-DQgOI0m3.js";import{T as st,N as at,A as rt,S as R}from"./Textarea-DMa3ZNHI.js";import{P as nt,T as it,L as lt,D as ot,F as ke,a as _,A as dt}from"./api-BUPf7_3X.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=A("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=A("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=A("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=A("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=A("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=A("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=A("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),De={sm:"h-1",md:"h-2",lg:"h-3"},pt={default:"bg-purple-600",success:"bg-green-500",warning:"bg-yellow-500",gradient:"bg-gradient-to-r from-purple-600 to-pink-600"};function ft({value:t,max:n=100,label:d,showPercentage:m=!1,size:r="md",variant:v="gradient",className:o=""}){const g=Math.min(Math.max(t/n*100,0),100);return e.jsxs("div",{className:o,children:[(d||m)&&e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d&&e.jsx("span",{className:"text-sm font-medium text-gray-700",children:d}),m&&e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(g),"%"]})]}),e.jsx("div",{className:`w-full bg-gray-200 rounded-full overflow-hidden ${De[r]}`,children:e.jsx("div",{className:`${De[r]} ${pt[v]} rounded-full transition-all duration-500 ease-out`,style:{width:`${g}%`}})})]})}const bt=[{id:"christmas",name:{en:"Christmas Story",de:`Weihnachts-
Geschichte`,fr:"Histoire de NoÃ«l"},emoji:"ðŸŽ„"},{id:"newyear",name:{en:"New Year Story",de:`Neujahrs-
Geschichte`,fr:"Histoire du Nouvel An"},emoji:"ðŸŽ†"},{id:"pirate",name:{en:"Pirate Adventure",de:"Piraten-Abenteuer",fr:"Aventure de Pirates"},emoji:"ðŸ´â€â˜ ï¸"},{id:"cowboy",name:{en:"Wild West",de:"Wilder Westen",fr:"Far West"},emoji:"ðŸ¤ "},{id:"fireman",name:{en:"Brave Firefighter",de:"Tapferer Feuerwehrmann",fr:"Pompier Courageux"},emoji:"ðŸš’"},{id:"unicorn",name:{en:"Magical Unicorn",de:"Magisches Einhorn",fr:"Licorne Magique"},emoji:"ðŸ¦„"},{id:"ninja",name:{en:"Secret Ninja",de:"Geheimer Ninja",fr:"Ninja Secret"},emoji:"ðŸ¥·"},{id:"space",name:{en:"Space Explorer",de:"Weltraum-Entdecker",fr:"Explorateur Spatial"},emoji:"ðŸš€"},{id:"dinosaur",name:{en:"Dinosaur World",de:"Dinosaurier-Welt",fr:"Monde des Dinosaures"},emoji:"ðŸ¦–"},{id:"princess",name:{en:"Princess Story",de:"Prinzessinnen-Geschichte",fr:"Histoire de Princesse"},emoji:"ðŸ‘‘"},{id:"knight",name:{en:"Knight Adventure",de:"Ritter-Abenteuer",fr:"Aventure de Chevalier"},emoji:"âš”ï¸"},{id:"detective",name:{en:"Detective Mystery",de:"Detektiv-Geheimnis",fr:"MystÃ¨re de DÃ©tective"},emoji:"ðŸ”"}];function yt({selectedType:t,onSelect:n,customTypes:d=[],onAddCustom:m}){const{t:r,language:v}=z(),o=[...bt,...d];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:r.chooseStoryType}),e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-2",children:[o.map(g=>e.jsxs("button",{onClick:()=>n(g.id),className:`p-2 rounded-lg border-2 transition-all ${t===g.id?"border-indigo-600 bg-indigo-50 shadow-lg":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:g.emoji}),e.jsx("div",{className:"font-semibold text-xs",children:g.name[v]})]},g.id)),m&&e.jsxs("button",{onClick:m,className:"p-2 rounded-lg border-2 border-dashed border-indigo-300 hover:border-indigo-600 transition-all hover:bg-indigo-50",children:[e.jsx("div",{className:"text-2xl mb-1",children:e.jsx(O,{size:24,className:"mx-auto text-indigo-600"})}),e.jsx("div",{className:"font-semibold text-xs text-indigo-600",children:r.addCustomStoryType})]})]})]})}const jt=[{id:"pixar",name:{en:"Pixar 3D",de:"Pixar 3D",fr:"Pixar 3D"},emoji:"ðŸŽ¬",image:"/images/Pixar style.jpg",description:{en:"Vibrant, warm Disney/Pixar style 3D animation",de:"Lebendige, warme Disney/Pixar 3D-Animation",fr:"Animation 3D Disney/Pixar vibrante et chaleureuse"},prompt:"pixar style 3d character, vibrant Disney/Pixar 3D animation, warm lighting, child-friendly"},{id:"cartoon",name:{en:"Cartoon",de:"Cartoon",fr:"Dessin animÃ©"},emoji:"ðŸŽ¨",image:"/images/cartoon style.jpg",description:{en:"Classic 2D cartoon style with bold colors",de:"Klassischer 2D-Cartoon-Stil mit krÃ¤ftigen Farben",fr:"Style cartoon 2D classique aux couleurs vives"},prompt:"2D cartoon style, bold outlines, vibrant flat colors, classic animation look"},{id:"anime",name:{en:"Anime",de:"Anime",fr:"Anime"},emoji:"â­",image:"/images/anime style.jpg",description:{en:"Japanese anime style with expressive features",de:"Japanischer Anime-Stil mit ausdrucksstarken Features",fr:"Style anime japonais aux traits expressifs"},prompt:"anime style, Japanese animation, expressive eyes, dynamic poses, cel-shaded"},{id:"chibi",name:{en:"Chibi",de:"Chibi",fr:"Chibi"},emoji:"ðŸŒ¸",image:"/images/chibi style.jpg",description:{en:"Cute chibi style with big heads and small bodies",de:"Niedlicher Chibi-Stil mit groÃŸen KÃ¶pfen und kleinen KÃ¶rpern",fr:"Style chibi mignon avec grandes tÃªtes et petits corps"},prompt:"chibi style, super deformed, cute, big head, small body, kawaii, adorable"},{id:"steampunk",name:{en:"Steampunk",de:"Steampunk",fr:"Steampunk"},emoji:"âš™ï¸",image:"/images/steampunk.jpg",description:{en:"Victorian-era inspired with gears and brass",de:"Von der viktorianischen Ã„ra inspiriert mit ZahnrÃ¤dern und Messing",fr:"InspirÃ© de l'Ã¨re victorienne avec engrenages et laiton"},prompt:"steampunk style, Victorian era, gears, brass, copper, goggles, mechanical details, vintage technology"},{id:"comic",name:{en:"Comic Book",de:"Comic",fr:"Bande dessinÃ©e"},emoji:"ðŸ’¥",image:"/images/comic book style.jpg",description:{en:"Comic book style with bold lines and halftone",de:"Comic-Stil mit krÃ¤ftigen Linien und Raster",fr:"Style bande dessinÃ©e avec lignes Ã©paisses et trames"},prompt:"comic book style, bold ink lines, halftone dots, dynamic action, speech bubbles aesthetic, superhero comic art"},{id:"manga",name:{en:"Manga",de:"Manga",fr:"Manga"},emoji:"ðŸ“š",image:"/images/manga style.jpg",description:{en:"Japanese manga style, black and white with screentones",de:"Japanischer Manga-Stil, schwarz-weiÃŸ mit Rastern",fr:"Style manga japonais, noir et blanc avec trames"},prompt:"manga style, Japanese comic art, detailed linework, screentones, dramatic shading, expressive characters"}];function vt({selectedStyle:t,onSelect:n}){const{t:d,language:m}=z();return e.jsxs("div",{id:"art-style-section",className:"md:bg-indigo-50 md:border-2 md:border-indigo-200 md:rounded-lg md:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(mt,{size:18,className:"text-indigo-600"}),e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-800",children:d.chooseArtStyle})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-2 md:mb-3",children:d.artStyleDescription}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 gap-2",children:jt.map(r=>e.jsxs("button",{onClick:()=>n(r.id),className:`rounded-lg border-2 transition-all overflow-hidden flex flex-col bg-white ${t===r.id?"border-indigo-600 shadow-lg ring-2 ring-indigo-200":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"relative w-full h-32 overflow-hidden",children:e.jsx("img",{src:r.image,alt:r.name[m],className:"w-full h-full object-cover"})}),e.jsx("div",{className:"p-1.5 flex flex-col items-center text-center",children:e.jsx("div",{className:"font-bold text-xs text-gray-800",children:r.name[m]})})]},r.id))})]})}const le=[{value:{en:"Best Friends with",de:"Beste Freunde mit",fr:"Meilleurs amis avec"},inverse:{en:"Best Friends with",de:"Beste Freunde mit",fr:"Meilleurs amis avec"}},{value:{en:"Friends with",de:"Freunde mit",fr:"Amis avec"},inverse:{en:"Friends with",de:"Freunde mit",fr:"Amis avec"}},{value:{en:"Married to",de:"Verheiratet mit",fr:"MariÃ©(e) Ã "},inverse:{en:"Married to",de:"Verheiratet mit",fr:"MariÃ©(e) Ã "}},{value:{en:"In a relationship with",de:"In einer Beziehung mit",fr:"En relation avec"},inverse:{en:"In a relationship with",de:"In einer Beziehung mit",fr:"En relation avec"}},{value:{en:"Older Sibling of",de:"Ã„lteres Geschwister von",fr:"FrÃ¨re/SÅ“ur aÃ®nÃ©(e) de"},inverse:{en:"Younger Sibling of",de:"JÃ¼ngeres Geschwister von",fr:"FrÃ¨re/SÅ“ur cadet(te) de"}},{value:{en:"Younger Sibling of",de:"JÃ¼ngeres Geschwister von",fr:"FrÃ¨re/SÅ“ur cadet(te) de"},inverse:{en:"Older Sibling of",de:"Ã„lteres Geschwister von",fr:"FrÃ¨re/SÅ“ur aÃ®nÃ©(e) de"}},{value:{en:"Parent of",de:"Elternteil von",fr:"Parent de"},inverse:{en:"Child of",de:"Kind von",fr:"Enfant de"}},{value:{en:"Child of",de:"Kind von",fr:"Enfant de"},inverse:{en:"Parent of",de:"Elternteil von",fr:"Parent de"}},{value:{en:"Rivals with",de:"Rivalen mit",fr:"Rivaux avec"},inverse:{en:"Rivals with",de:"Rivalen mit",fr:"Rivaux avec"}},{value:{en:"Neighbors with",de:"Nachbarn mit",fr:"Voisins avec"},inverse:{en:"Neighbors with",de:"Nachbarn mit",fr:"Voisins avec"}},{value:{en:"Not Known to",de:"Nicht bekannt mit",fr:"Pas connu de"},inverse:{en:"Not Known to",de:"Nicht bekannt mit",fr:"Pas connu de"}}];function Me(t){const n=le.find(d=>d.value.en==="Not Known to");return n?n.value[t]:"Not Known to"}function Ee(t){const n=le.find(d=>d.value.en==="Not Known to");return n?t===n.value.en||t===n.value.de||t===n.value.fr:!1}function Nt({characters:t,relationships:n,relationshipTexts:d,onRelationshipChange:m,onRelationshipTextChange:r,customRelationships:v=[],onAddCustomRelationship:o}){const{t:g,language:h}=z(),b=h,k=[...le,...v.map(c=>({value:{en:c,de:c,fr:c},inverse:{en:c,de:c,fr:c}}))],P=(c,f,a)=>{if(a==="__CREATE_CUSTOM__"){const N=prompt(h==="de"?"Beziehung eingeben:":h==="fr"?"Entrer la relation:":"Enter relationship:");N&&N.trim()&&(o==null||o(N.trim()),m(c,f,N.trim()))}else m(c,f,a)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(gt,{size:24})," ",g.defineRelationships]}),e.jsx("p",{className:"text-sm text-gray-500",children:g.defineRelationshipsDesc}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:t.map((c,f)=>t.map((a,N)=>{if(f>=N)return null;const i=`${c.id}-${a.id}`,u=n[i],D=!u||Ee(u);return e.jsx("div",{className:`rounded-lg p-3 md:p-4 ${D?"bg-white border-red-500 border-[3px]":"bg-blue-50 border-blue-300 border-2"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-3 md:gap-6 max-w-[75%] mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-shrink-0",children:[c.photoUrl&&e.jsx("img",{src:c.photoUrl,alt:c.name,className:"w-14 h-14 md:w-16 md:h-16 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-center max-w-[80px] truncate",children:c.name})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1 min-w-0",children:[e.jsxs("select",{value:u||Me(b),onChange:w=>P(c.id,a.id,w.target.value),className:`w-full max-w-[500px] px-2 py-1.5 border rounded text-sm font-medium text-center ${D?"bg-white border-red-400 border-2":"bg-blue-100 border-blue-400"}`,children:[e.jsxs("option",{value:"__CREATE_CUSTOM__",children:["+ ",b==="de"?"Eigene":b==="fr"?"PersonnalisÃ©":"Custom"]}),k.map((w,S)=>e.jsx("option",{value:w.value[b],children:w.value[b]},S))]}),!D&&e.jsx("input",{type:"text",value:d[i]||"",onChange:w=>r(i,w.target.value),placeholder:b==="de"?"Details...":b==="fr"?"DÃ©tails...":"Details...",className:"w-full max-w-[500px] px-2 py-1 border border-blue-300 rounded text-xs text-center bg-white"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-shrink-0",children:[a.photoUrl&&e.jsx("img",{src:a.photoUrl,alt:a.name,className:"w-14 h-14 md:w-16 md:h-16 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-center max-w-[80px] truncate",children:a.name})]})]})},i)}))})]})}function wt({characters:t,mainCharacters:n,onToggleMainCharacter:d,languageLevel:m,onLanguageLevelChange:r,pages:v,onPagesChange:o,dedication:g,onDedicationChange:h,storyDetails:b,onStoryDetailsChange:k,developerMode:P=!1}){const{t:c,language:f}=z(),a=[{value:"1st-grade",label:c.firstGrade,desc:c.firstGradeDesc,image:"/images/text and image on each page.jpg"},{value:"standard",label:c.standard,desc:c.standardDesc,image:"/images/left page text, right page image.jpg"},{value:"advanced",label:c.advanced,desc:c.advancedDesc,image:"/images/dense text left.jpg"}],N=(i,u=!1)=>{const D=u?" (Test)":"";if(m==="1st-grade")return`${i} ${f==="de"?"Seiten":"pages"}${D}`;const w=i/2,S=i/2;return f==="de"?`${i} Seiten (${w} Text + ${S} Bilder)${D}`:f==="fr"?`${i} pages (${w} texte + ${S} images)${D}`:`${i} pages (${w} text + ${S} images)${D}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(xt,{size:24})," ",c.storySettings]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:c.selectMainCharacters}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:t.map(i=>e.jsx("button",{onClick:()=>d(i.id),className:`p-4 rounded-lg border-2 transition-all text-left ${n.includes(i.id)?"border-indigo-600 bg-indigo-50":"border-gray-200 hover:border-indigo-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[i.photoUrl&&e.jsx("img",{src:i.photoUrl,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-bold text-base flex items-center gap-2",children:[i.name,e.jsx("span",{className:n.includes(i.id)?"inline-block":"hidden",children:e.jsx(ut,{size:16,className:"text-indigo-600"})})]}),e.jsxs("div",{className:"text-sm md:text-base text-gray-500",children:[i.gender==="male"?c.male:i.gender==="female"?c.female:c.other,", ",i.age]})]})]})},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:c.readingLevel}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a.map(i=>e.jsxs("button",{onClick:()=>r(i.value),className:`text-left rounded-lg border-2 transition-all overflow-hidden ${m===i.value?"border-indigo-600 ring-2 ring-indigo-200":"border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"w-full bg-gray-100 p-2",children:e.jsx("img",{src:i.image,alt:i.label,className:"w-full h-auto object-contain"})}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"font-semibold text-base",children:i.label}),e.jsx("div",{className:"text-sm text-gray-500",children:i.desc})]})]},i.value))})]}),m&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xl font-semibold mb-3",children:c.numberOfPages}),e.jsxs("select",{value:v,onChange:i=>o(parseInt(i.target.value)),className:"w-full px-4 py-3 border-2 border-indigo-200 rounded-lg focus:border-indigo-600 focus:outline-none text-base md:text-lg font-semibold",children:[P&&e.jsx("option",{value:"10",children:N(10,!0)}),e.jsx("option",{value:"30",children:N(30)}),e.jsx("option",{value:"40",children:N(40)}),e.jsx("option",{value:"50",children:N(50)})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:m==="1st-grade"?f==="de"?"Jede Seite enthÃ¤lt ein Bild mit Text darunter":f==="fr"?"Chaque page contient une image avec du texte en dessous":"Each page contains an image with text below":f==="de"?"Abwechselnd Textseite und Bildseite":f==="fr"?"Alternance de pages de texte et d'images":"Alternating text page and image page"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-gray-800 mb-2",children:c.storyDetails}),e.jsx("textarea",{value:b,onChange:i=>k(i.target.value),placeholder:c.storyDetailsPlaceholder,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-base",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-gray-800 mb-2",children:f==="de"?"Widmung (Optional)":f==="fr"?"DÃ©dicace (Facultatif)":"Dedication (Optional)"}),e.jsx("textarea",{value:g,onChange:i=>h(i.target.value),placeholder:f==="de"?'z.B. "FÃ¼r meine liebe Tochter Emma zum 5. Geburtstag"':f==="fr"?'Par exemple "Pour ma chÃ¨re fille Emma pour son 5Ã¨me anniversaire"':'e.g. "For my dear daughter Emma on her 5th birthday"',className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-base",rows:2,maxLength:200}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:f==="de"?"Dieser Text wird auf Seite 0 Ihres Buches gedruckt. Wenn Sie nichts eingeben, wird Seite 0 nur eine Illustration ohne Text enthalten.":f==="fr"?"Ce texte sera imprimÃ© sur la page 0 de votre livre. Si vous ne saisissez rien, la page 0 ne contiendra qu'une illustration sans texte.":"This text will be printed on page 0 of your book. If you leave it empty, page 0 will contain only an illustration with no text."})]})]})]})}function Ct({characters:t,showSuccessMessage:n,onEdit:d,onDelete:m,onCreateAnother:r,onContinue:v}){const{t:o,language:g}=z();return t.length===0?null:e.jsxs("div",{className:"space-y-4",children:[n&&e.jsx("div",{className:"md:bg-green-50 md:border-2 md:border-green-400 md:rounded-xl p-4 animate-fade-in",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center",children:e.jsx(ct,{size:20})}),e.jsx("h3",{className:"text-lg font-bold text-green-700",children:g==="de"?"Charakter erfolgreich erstellt!":g==="fr"?"Personnage cre avec succes!":"Character Created Successfully!"})]})}),e.jsxs("div",{className:"bg-white border-2 border-indigo-200 rounded-lg p-3",children:[e.jsx("h3",{className:"text-base font-bold text-gray-800 mb-2",children:o.yourCharacters}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:t.map(h=>e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[h.photoUrl&&e.jsx("img",{src:h.photoUrl,alt:h.name,className:"w-12 h-12 md:w-16 md:h-16 rounded-full object-cover border-2 border-indigo-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-sm md:text-base truncate",children:h.name}),e.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:[h.gender==="male"?o.male:h.gender==="female"?o.female:o.other,","," ",h.age," ",g==="de"?"J":g==="fr"?"ans":"y"]})]})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>d(h),className:"bg-indigo-600 text-white px-2 md:px-3 py-1 rounded text-xs hover:bg-indigo-700 flex items-center gap-1",children:[e.jsx(nt,{size:12}),o.editCharacter]}),e.jsxs("button",{onClick:()=>m(h.id),className:"bg-red-500 text-white px-2 md:px-3 py-1 rounded text-xs hover:bg-red-600 flex items-center gap-1",children:[e.jsx(it,{size:12}),o.deleteCharacter]})]})]}),h.strengths&&h.strengths.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-green-600",children:[o.strengths,":"]})," ",h.strengths.join(", ")]}),h.weaknesses&&h.weaknesses.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-orange-600",children:[o.weaknesses,":"]})," ",h.weaknesses.join(", ")]}),h.fears&&h.fears.length>0&&e.jsxs("p",{className:"text-xs text-gray-800 mb-1",children:[e.jsxs("strong",{className:"text-red-600",children:[o.fears,":"]})," ",h.fears.join(", ")]})]},h.id))})]}),e.jsxs("div",{className:"md:bg-indigo-50 md:border-2 md:border-indigo-200 md:rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-800 mb-4 text-center font-semibold",children:g==="de"?"Was mochten Sie als Nachstes tun?":g==="fr"?"Que voulez-vous faire ensuite?":"What would you like to do next?"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsx("button",{onClick:r,className:"bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 font-semibold flex items-center justify-center gap-2 transition-colors",children:g==="de"?"Weiteren Charakter erstellen":g==="fr"?"Creer un autre personnage":"Create Another Character"}),e.jsx("button",{onClick:v,className:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-semibold flex items-center justify-center gap-2 transition-colors",children:g==="de"?"Weiter zu Beziehungen":g==="fr"?"Continuer vers les relations":"Continue to Relationships"})]})]})]})}const St={success:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"},warning:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"},danger:{bg:"bg-indigo-100",selected:"bg-indigo-600 text-white",hover:"hover:bg-indigo-200",text:"text-indigo-700",border:"border-indigo-300"}};function ne({label:t,traits:n,selectedTraits:d,onSelect:m,minRequired:r=0,variant:v="success",allowCustom:o=!0}){const{t:g,language:h}=z(),[b,k]=p.useState(""),[P,c]=p.useState([]),f=St[v],a=u=>{d.includes(u)?m(d.filter(D=>D!==u)):m([...d,u])},N=()=>{if(b.trim()&&!d.includes(b.trim())){const u=b.trim();c([...P,u]),m([...d,u]),k("")}},i=[...n,...P];return e.jsxs("div",{className:`border ${f.border} rounded-lg p-3 ${f.bg.replace("100","50")}`,children:[e.jsxs("label",{className:`block text-sm font-semibold mb-2 ${f.text}`,children:[t," ",r>0&&e.jsxs("span",{className:"text-xs font-normal",children:["(",g.selectAtLeast," ",r,")"]}),d.length>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(",g.selected,": ",d.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:i.map(u=>e.jsx("button",{onClick:()=>a(u),className:`px-2 py-1 rounded text-xs transition-colors ${d.includes(u)?f.selected:`${f.bg} ${f.hover} text-gray-700`}`,children:u},u))}),o&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",value:b,onChange:u=>k(u.target.value),onKeyDown:u=>u.key==="Enter"&&N(),placeholder:h==="de"?"Eigene hinzufugen...":h==="fr"?"Ajouter personnalise...":"Add custom...",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"}),e.jsxs("button",{onClick:N,disabled:!b.trim(),className:`px-2 py-1 rounded text-xs font-semibold flex items-center gap-1 ${b.trim()?`${f.selected.split(" ")[0]} text-white hover:opacity-90`:"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(O,{size:12}),h==="de"?"Hinzufugen":h==="fr"?"Ajouter":"Add"]})]})]})}const kt={en:["Brave","Smart","Kind","Strong","Fast","Creative","Funny","Leader","Helpful","Patient","Honest","Loyal","Curious","Determined","Caring","Confident","Cheerful","Generous","Clever","Adventurous","Resourceful","Protective","Imaginative","Hardworking","Trustworthy"],de:["Mutig","Klug","Freundlich","Stark","Schnell","Kreativ","Lustig","FÃ¼hrungspersÃ¶nlichkeit","Hilfsbereit","Geduldig","Ehrlich","Treu","Neugierig","Entschlossen","FÃ¼rsorglich","Selbstbewusst","FrÃ¶hlich","GroÃŸzÃ¼gig","Schlau","Abenteuerlustig","Einfallsreich","BeschÃ¼tzend","Fantasievoll","FleiÃŸig","VertrauenswÃ¼rdig"],fr:["Courageux","Intelligent","Gentil","Fort","Rapide","CrÃ©atif","DrÃ´le","Leader","Serviable","Patient","HonnÃªte","Loyal","Curieux","DÃ©terminÃ©","AttentionnÃ©","Confiant","Joyeux","GÃ©nÃ©reux","Astucieux","Aventureux","DÃ©brouillard","Protecteur","Imaginatif","Travailleur","Digne de confiance"]},Pt={en:["Shy","Clumsy","Impatient","Forgetful","Messy","Talkative","Stubborn","Lazy","Greedy","Jealous","Anxious","Distracted","Reckless","Bossy","Easily scared","Too trusting","Perfectionist","Indecisive","Secretive","Boastful","Quick-tempered","Careless","Overly cautious","Selfish"],de:["SchÃ¼chtern","Tollpatschig","Ungeduldig","Vergesslich","Unordentlich","GesprÃ¤chig","Stur","Faul","Gierig","EifersÃ¼chtig","Ã„ngstlich","Abgelenkt","Leichtsinnig","HerrschsÃ¼chtig","Leicht Ã¤ngstlich","Zu vertrauensvoll","Perfektionist","Unentschlossen","Verschlossen","Prahlerisch","JÃ¤hzornig","NachlÃ¤ssig","Ãœbervorsichtig","Egoistisch"],fr:["Timide","Maladroit","Impatient","Distrait","DÃ©sordonnÃ©","Bavard","TÃªtu","Paresseux","Avide","Jaloux","Anxieux","Distrait","Imprudent","Autoritaire","Facilement effrayÃ©","Trop confiant","Perfectionniste","IndÃ©cis","Secret","Vantard","ColÃ©rique","NÃ©gligent","Trop prudent","Ã‰goÃ¯ste"]},Dt={en:["Fear of heights","Fear of spiders","Fear of the dark","Fear of being alone","Fear of loud noises"],de:["HÃ¶henangst","Angst vor Spinnen","Angst vor der Dunkelheit","Angst allein zu sein","Angst vor lauten GerÃ¤uschen"],fr:["Peur du vide","Peur des araignÃ©es","Peur du noir","Peur d'Ãªtre seul","Peur des bruits forts"]},Fe=kt,Te=Pt,ze=Dt;function Ft({character:t,onChange:n,onSave:d,onCancel:m,onPhotoChange:r,isLoading:v}){const{t:o,language:g}=z(),h=a=>{var i;const N=(i=a.target.files)==null?void 0:i[0];N&&r(N)},b=(a,N)=>{n({...t,[a]:N})},k=t.name&&t.strengths&&t.strengths.length>=3&&t.weaknesses&&t.weaknesses.length>=2,P=Fe[g]||Fe.en,c=Te[g]||Te.en,f=ze[g]||ze.en;return e.jsxs("div",{className:"bg-white border-2 border-indigo-200 rounded-lg p-3 space-y-3",children:[e.jsx("h3",{className:"text-base font-bold text-gray-800",children:t.id?o.editCharacter:o.startCreating}),e.jsx(et,{label:`${o.characterName} *`,value:t.name,onChange:a=>b("name",a.target.value),placeholder:o.characterName}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"md:border md:border-indigo-300 md:rounded-lg p-2 md:bg-indigo-50",children:[e.jsx("label",{className:"block text-xs font-semibold mb-2 text-center",children:o.characterPhoto}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.photoUrl&&e.jsx("img",{src:t.photoUrl,alt:"Character",className:"w-20 h-20 rounded-full object-cover border-2 border-indigo-400"}),e.jsxs("label",{className:"cursor-pointer bg-indigo-600 text-white px-3 py-1.5 rounded text-xs hover:bg-indigo-700 flex items-center gap-1 font-semibold transition-colors",children:[e.jsx(Be,{size:14})," ",o.uploadPhoto,e.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden"})]})]})]}),e.jsxs("div",{className:"md:border md:border-indigo-300 md:rounded-lg p-4 md:bg-indigo-50",children:[e.jsx("label",{className:"block text-xs font-semibold mb-3 text-center",children:g==="de"?"Eigenschaften":g==="fr"?"CaractÃ©ristiques":"Attributes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap min-w-[60px]",children:[o.gender,":"]}),e.jsxs("select",{value:t.gender,onChange:a=>b("gender",a.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded text-sm",children:[e.jsx("option",{value:"male",children:o.male}),e.jsx("option",{value:"female",children:o.female}),e.jsx("option",{value:"other",children:o.other})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap",children:[o.age,":"]}),e.jsx("input",{type:"number",value:t.age,onChange:a=>b("age",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",min:"1",max:"120"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap",children:[g==="de"?"Grosse":g==="fr"?"Taille":"Height",":"]}),e.jsx("input",{type:"text",value:t.height||"",onChange:a=>b("height",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",placeholder:"cm"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-xs font-semibold whitespace-nowrap min-w-[60px]",children:[o.hairColor,":"]}),e.jsx("input",{type:"text",value:t.hairColor||"",onChange:a=>b("hairColor",a.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded text-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-semibold block mb-1",children:[o.otherFeatures,":"]}),e.jsx("input",{type:"text",value:t.otherFeatures||"",onChange:a=>b("otherFeatures",a.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm",placeholder:o.descriptionPlaceholder})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ne,{label:o.strengths,traits:P,selectedTraits:t.strengths||[],onSelect:a=>b("strengths",a),minRequired:3,variant:"success"}),e.jsx(ne,{label:o.weaknesses,traits:c,selectedTraits:t.weaknesses||[],onSelect:a=>b("weaknesses",a),minRequired:2,variant:"warning"}),e.jsx(ne,{label:o.fears,traits:f,selectedTraits:t.fears||[],onSelect:a=>b("fears",a),variant:"danger"})]}),e.jsx(st,{label:o.specialDetails,value:t.specialDetails||"",onChange:a=>b("specialDetails",a.target.value),placeholder:o.specialDetailsPlaceholder,rows:3}),e.jsxs("div",{className:"flex gap-3",children:[m&&e.jsx("button",{onClick:m,className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:o.cancel}),e.jsx(ie,{onClick:d,disabled:!k||v,loading:v,icon:ht,className:m?"flex-1":"w-full",children:o.saveCharacter})]}),!k&&e.jsx("p",{className:"text-xs text-red-500 text-center",children:g==="de"?"Bitte Name eingeben, mind. 3 Starken und 2 Schwachen wahlen":g==="fr"?"Veuillez entrer un nom, selectionner au moins 3 forces et 2 faiblesses":"Please enter a name, select at least 3 strengths and 2 weaknesses"})]})}function Tt({onPhotoSelect:t,showExamples:n=!0}){const{t:d,language:m}=z(),r=v=>{var g;const o=(g=v.target.files)==null?void 0:g[0];o&&t(o)};return e.jsxs("div",{className:"bg-indigo-50 border-2 border-indigo-300 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-indigo-700 mb-4 text-center",children:d.uploadPhotoFirst}),e.jsx("div",{className:"text-center mb-5",children:e.jsxs("label",{className:"cursor-pointer inline-flex items-center justify-center gap-3 bg-indigo-600 text-white px-10 py-4 rounded-xl text-xl hover:bg-indigo-700 font-bold shadow-lg transition-colors",children:[e.jsx(Be,{size:28})," ",d.uploadPhoto,e.jsx("input",{type:"file",accept:"image/*",onChange:r,className:"hidden"})]})}),n&&e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/Full body.jpg",alt:"Full body example",className:"w-full md:max-h-32 object-contain rounded border-2 border-green-400 mb-1"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["âœ“ ",m==="de"?"GanzkÃ¶rper":m==="fr"?"Corps entier":"Full body"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/Upper body.jpg",alt:"Upper body example",className:"w-full md:max-h-32 object-contain rounded border-2 border-green-400 mb-1"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["âœ“ ",m==="de"?"OberkÃ¶rper":m==="fr"?"Buste":"Upper body"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/No zoomed in close up.jpg",alt:"Too close example",className:"w-full md:max-h-32 object-contain rounded border-2 border-red-400 mb-1"}),e.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["âœ— ",m==="de"?"Nahaufnahme/Unscharf":m==="fr"?"Gros plan/Flou":"Close-up/Blurry"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/images/No sunglasses, hat or helmets.jpg",alt:"No accessories example",className:"w-full md:max-h-32 object-contain rounded border-2 border-red-400 mb-1"}),e.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["âœ— ",m==="de"?"Brille/Hut/Helm":m==="fr"?"Lunettes/Chapeau":"Glasses/Hat/Helmet"]})]})]})})]})}function zt({current:t,total:n,message:d,isGenerating:m=!0}){const{language:r}=z();return!m||n===0?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8 text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(lt,{size:48,className:"animate-spin text-indigo-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:r==="de"?"Generiere Geschichte...":r==="fr"?"Generation en cours...":"Generating Story..."})]}),e.jsx(ft,{value:t,max:n,showPercentage:!0,size:"lg",className:"mb-4"}),d&&e.jsx("p",{className:"text-gray-600 text-sm",children:d}),e.jsx("p",{className:"text-gray-400 text-xs mt-4",children:r==="de"?"Bitte warten Sie, dies kann einige Minuten dauern...":r==="fr"?"Veuillez patienter, cela peut prendre quelques minutes...":"Please wait, this may take a few minutes..."})]})})}function At({title:t,story:n,sceneImages:d,languageLevel:m="standard",isGenerating:r=!1,onDownloadPdf:v,onBuyBook:o,onCreateAnother:g,onDownloadTxt:h,storyId:b,developerMode:k=!1}){const{t:P,language:c}=z(),f=m==="1st-grade",N=(u=>u?u.split(/(?:---\s*(?:Page|Seite)\s+\d+\s*---|##\s*(?:Page|Seite)\s+\d+)/i).slice(1).filter(w=>w.trim().length>0):[])(n),i=d.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center flex-wrap gap-3",children:e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(tt,{size:24})," ",P.yourStory]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[k&&h&&e.jsxs("button",{onClick:h,className:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-semibold flex items-center justify-center gap-2",children:[e.jsx(ot,{size:20})," ",P.downloadTXT]}),i&&v&&e.jsxs("button",{onClick:v,disabled:r,className:`bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-green-600"}`,children:[e.jsx(ke,{size:20})," ",c==="de"?"PDF herunterladen":c==="fr"?"TÃ©lÃ©charger PDF":"Download PDF"]}),i&&b&&o&&e.jsxs("button",{onClick:o,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(Pe,{size:20})," ",c==="de"?"Buch kaufen (CHF 36)":c==="fr"?"Acheter le livre (CHF 36)":"Buy Book (CHF 36)"]}),g&&e.jsxs("button",{onClick:g,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 sm:col-span-2 lg:col-span-1 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(O,{size:20})," ",P.createAnotherStory]})]}),i&&n&&e.jsxs("div",{className:"space-y-8 mt-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 text-center mb-6",children:t||(c==="de"?"Ihre Geschichte":c==="fr"?"Votre histoire":"Your Story")}),N.map((u,D)=>{const w=D+1,S=d.find(B=>B.pageNumber===w);return e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:c==="de"?`Seite ${w}`:c==="fr"?`Page ${w}`:`Page ${w}`}),f?e.jsxs("div",{className:"flex flex-col items-center max-w-2xl mx-auto",children:[S&&S.imageData?e.jsx("div",{className:"w-full mb-4",children:e.jsx("img",{src:S.imageData,alt:`Scene for page ${w}`,className:"w-full rounded-lg shadow-md object-cover"})}):e.jsx("div",{className:"w-full flex items-center justify-center bg-gray-100 rounded-lg p-8 mb-4",children:e.jsx("p",{className:"text-gray-500 text-center",children:c==="de"?"Kein Bild fÃ¼r diese Seite":c==="fr"?"Pas d'image pour cette page":"No image for this page"})}),e.jsx("div",{className:"w-full bg-indigo-50 rounded-lg p-6 border-2 border-indigo-200",children:e.jsx("p",{className:"text-gray-800 leading-relaxed whitespace-pre-wrap font-serif text-xl text-center",children:u.trim()})})]}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[S&&S.imageData?e.jsx("div",{className:"flex flex-col",children:e.jsx("img",{src:S.imageData,alt:`Scene for page ${w}`,className:"w-full rounded-lg shadow-md object-cover"})}):e.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-lg p-8",children:e.jsx("p",{className:"text-gray-500 text-center",children:c==="de"?"Kein Bild fÃ¼r diese Seite":c==="fr"?"Pas d'image pour cette page":"No image for this page"})}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{className:"text-gray-800 leading-relaxed whitespace-pre-wrap font-serif text-xl",children:u.trim()})})})]})]},w)})]}),i&&n&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-xl p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4 text-center",children:c==="de"?"Was mÃ¶chten Sie als NÃ¤chstes tun?":c==="fr"?"Que souhaitez-vous faire ensuite ?":"What would you like to do next?"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[v&&e.jsxs("button",{onClick:v,disabled:r,className:`bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-green-600"}`,children:[e.jsx(ke,{size:20})," ",c==="de"?"PDF herunterladen":c==="fr"?"TÃ©lÃ©charger PDF":"Download PDF"]}),b&&o&&e.jsxs("button",{onClick:o,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(Pe,{size:20})," ",c==="de"?"Buch kaufen (CHF 36)":c==="fr"?"Acheter le livre (CHF 36)":"Buy Book (CHF 36)"]}),g&&e.jsxs("button",{onClick:g,disabled:r,className:`bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${r?"opacity-50 cursor-not-allowed":"hover:bg-indigo-600"}`,children:[e.jsx(O,{size:20})," ",P.createAnotherStory]})]})]})]})}function Ae(t){return{id:t.id,name:t.name,gender:t.gender,age:t.age,height:t.height,build:t.build,hairColor:t.hair_color,otherFeatures:t.other_features,clothing:t.clothing,specialDetails:t.special_details,strengths:t.strengths||[],weaknesses:t.weaknesses||[],fears:t.fears||[],photoUrl:t.photo_url,bodyPhotoUrl:t.body_photo_url,bodyNoBgUrl:t.body_no_bg_url,faceBox:t.face_box,bodyBox:t.body_box}}function $e(t){return{id:t.id,name:t.name,gender:t.gender,age:t.age,height:t.height,build:t.build,hair_color:t.hairColor,other_features:t.otherFeatures,clothing:t.clothing,special_details:t.specialDetails,strengths:t.strengths,weaknesses:t.weaknesses,fears:t.fears,photo_url:t.photoUrl,body_photo_url:t.bodyPhotoUrl,body_no_bg_url:t.bodyNoBgUrl,face_box:t.faceBox,body_box:t.bodyBox}}const U={async getCharacters(){return((await _.get("/api/characters")).characters||[]).map(Ae)},async getCharacterData(){const t=await _.get("/api/characters");return{characters:(t.characters||[]).map(Ae),relationships:t.relationships||{},relationshipTexts:t.relationshipTexts||{},customRelationships:t.customRelationships||[],customStrengths:t.customStrengths||[],customWeaknesses:t.customWeaknesses||[],customFears:t.customFears||[]}},async saveCharacters(t){await _.post("/api/characters",{characters:t.map($e)})},async saveCharacterData(t){await _.post("/api/characters",{characters:t.characters.map($e),relationships:t.relationships,relationshipTexts:t.relationshipTexts,customRelationships:t.customRelationships,customStrengths:t.customStrengths,customWeaknesses:t.customWeaknesses,customFears:t.customFears})},async analyzePhoto(t){try{const n=await _.post("/api/analyze-photo",{imageData:t});return{success:n.success,faceThumbnail:n.faceThumbnail,bodyCrop:n.bodyCrop,bodyNoBg:n.bodyNoBg,faceBox:n.faceBox,bodyBox:n.bodyBox,attributes:n.attributes?{age:n.attributes.age,gender:n.attributes.gender,height:n.attributes.height,build:n.attributes.build,hairColor:n.attributes.hair_color,clothing:n.attributes.clothing}:void 0}}catch(n){return console.error("Photo analysis failed:",n),{success:!1}}}};function _t(){const t=Xe(),{t:n,language:d}=z(),{isAuthenticated:m}=Ze(),[r,v]=p.useState(1),[o,g]=p.useState(!1),[h,b]=p.useState(!1),[k,P]=p.useState(""),[c,f]=p.useState("pixar"),[a,N]=p.useState([]),[i,u]=p.useState(null),[D,w]=p.useState(!1),[S,B]=p.useState({}),[I,V]=p.useState({}),[L,oe]=p.useState([]),J=p.useRef(null),Re=p.useRef(!1),[M,G]=p.useState(()=>{try{const s=localStorage.getItem("story_main_characters");return s?JSON.parse(s):[]}catch{return[]}}),[H,_e]=p.useState(()=>{try{return localStorage.getItem("story_language_level")||"standard"}catch{return"standard"}}),[q,Ue]=p.useState(()=>{try{const s=localStorage.getItem("story_pages");return s?parseInt(s):30}catch{return 30}}),[Y,Ie]=p.useState(()=>localStorage.getItem("story_dedication")||""),[Q,Le]=p.useState(()=>localStorage.getItem("story_details")||""),[Z,de]=p.useState(!1),[X,W]=p.useState({current:0,total:0,message:""}),[ce,ge]=p.useState(""),[K,me]=p.useState(""),[,he]=p.useState([]),[Ge]=p.useState([]);p.useEffect(()=>{m||t("/")},[m,t]);const ue=s=>{if(s.length===0)return;const l=s.filter(x=>{const y=parseInt(x.age);return y>=1&&y<=10});if(l.length>0){const x=l.map(y=>y.id);G(x),console.log(`Auto-selected ${l.length} main character(s) aged 1-10`)}else{const x=s.reduce((y,C)=>{const j=parseInt(C.age)||999,T=parseInt(y.age)||999;return j<T?C:y});G([x.id]),console.log(`Auto-selected youngest character as main: ${x.name} (age ${x.age})`)}};p.useEffect(()=>{m&&(async()=>{try{g(!0);const l=await U.getCharacterData();console.log("Loaded character data from API:",{characters:l.characters.length,relationships:Object.keys(l.relationships).length}),N(l.characters),Object.keys(l.relationships).length>0&&(B(l.relationships),Re.current=!0),Object.keys(l.relationshipTexts).length>0&&V(l.relationshipTexts),l.customRelationships.length>0&&oe(l.customRelationships),l.characters.length>0&&ue(l.characters)}catch(l){console.error("Failed to load character data:",l)}finally{g(!1)}})()},[m]),p.useEffect(()=>{r===2&&a.length===0&&!i&&!o&&ee()},[r,a.length,i,o]),p.useEffect(()=>{localStorage.setItem("story_main_characters",JSON.stringify(M))},[M]),p.useEffect(()=>{localStorage.setItem("story_language_level",H)},[H]),p.useEffect(()=>{localStorage.setItem("story_pages",q.toString())},[q]),p.useEffect(()=>{localStorage.setItem("story_dedication",Y)},[Y]),p.useEffect(()=>{localStorage.setItem("story_details",Q)},[Q]),p.useEffect(()=>{if(r===3&&a.length>=2&&!o){const s=a.map(l=>l.id).sort().join("-");if(!J.current||J.current!==s){const l=d;console.log("Initializing relationships for step 3, charKey:",s,"existing:",Object.keys(S).length),B(x=>{const y={...x};let C=!1;return a.forEach((j,T)=>{a.forEach((ae,re)=>{if(T<re){const F=`${j.id}-${ae.id}`;y[F]||(y[F]=Me(l),C=!0,console.log("Initializing missing relationship:",F))}})}),C?y:x}),J.current=s}}},[r,a,d,o]);const xe=()=>{if(a.length<2)return!0;for(let s=0;s<a.length;s++)for(let l=s+1;l<a.length;l++){const x=`${a[s].id}-${a[l].id}`,y=S[x];if(!y||Ee(y))return!1}return!0},ee=()=>{u({id:Date.now(),name:"",gender:"other",age:"8",strengths:[],weaknesses:[],fears:[]}),w(!1)},pe=async s=>{const l=new FileReader;l.onload=async x=>{var C;const y=(C=x.target)==null?void 0:C.result;try{g(!0);const j=await U.analyzePhoto(y);if(j.success){const T=j.faceThumbnail||y,ae=j.bodyCrop||y,re=j.bodyNoBg||void 0;console.log("Photo analysis successful:",{hasFaceThumbnail:!!j.faceThumbnail,hasBodyCrop:!!j.bodyCrop,hasBodyNoBg:!!j.bodyNoBg}),u(F=>{var ye,je,ve,Ne,we,Ce;return F?{...F,photoUrl:T,bodyPhotoUrl:ae,bodyNoBgUrl:re,faceBox:j.faceBox,bodyBox:j.bodyBox,gender:((ye=j.attributes)==null?void 0:ye.gender)||F.gender,age:((je=j.attributes)==null?void 0:je.age)||F.age,height:((ve=j.attributes)==null?void 0:ve.height)||F.height,build:((Ne=j.attributes)==null?void 0:Ne.build)||F.build,hairColor:((we=j.attributes)==null?void 0:we.hairColor)||F.hairColor,clothing:((Ce=j.attributes)==null?void 0:Ce.clothing)||F.clothing}:null})}else console.warn("Photo analysis failed, using original photo"),u(T=>T?{...T,photoUrl:y}:null)}catch(j){console.error("Photo analysis error:",j),u(T=>T?{...T,photoUrl:y}:null)}finally{g(!1)}},l.readAsDataURL(s)},He=async()=>{if(i){g(!0);try{const l=i.id&&a.find(x=>x.id===i.id)?a.map(x=>x.id===i.id?i:x):[...a,i];console.log("Saving characters with relationships:",l.length),await U.saveCharacterData({characters:l,relationships:S,relationshipTexts:I,customRelationships:L,customStrengths:[],customWeaknesses:[],customFears:[]}),console.log("Character data saved successfully"),N(l),ue(l),u(null),w(!0)}catch(s){console.error("Failed to save character:",s),alert("Failed to save character. Please try again.")}finally{g(!1)}}},We=s=>{u({...s}),w(!1)},Ke=async s=>{const l=a.filter(C=>C.id!==s),x={...S},y={...I};Object.keys(x).forEach(C=>{(C.includes(`${s}-`)||C.includes(`-${s}`))&&(delete x[C],delete y[C])});try{await U.saveCharacterData({characters:l,relationships:x,relationshipTexts:y,customRelationships:L,customStrengths:[],customWeaknesses:[],customFears:[]}),N(l),B(x),V(y),G(C=>C.filter(j=>j!==s))}catch(C){console.error("Failed to delete character:",C)}},Oe=(s,l,x)=>{const y=`${s}-${l}`;console.log("Updating relationship:",y,"=",x),B(C=>{const j={...C,[y]:x};return console.log("New relationships state:",j),j})},Ve=s=>{oe(l=>[...l,s])},Je=s=>{G(l=>l.includes(s)?l.filter(x=>x!==s):[...l,s])},te=s=>{s>=0&&s<=5&&v(s)},qe=s=>s===1?!0:s===2?k!=="":s===3?k!==""&&a.length>0:s===4?k!==""&&a.length>0&&xe():s===5?K!=="":!1,$=()=>r===1?k!=="":r===2?a.length>0:r===3?xe():r===4?M.length>0:!1,fe=async()=>{if(a.length!==0)try{await U.saveCharacterData({characters:a,relationships:S,relationshipTexts:I,customRelationships:L,customStrengths:[],customWeaknesses:[],customFears:[]}),console.log("Character data auto-saved")}catch(s){console.error("Failed to auto-save character data:",s)}},be=async()=>{r<4&&$()&&(r===3&&await fe(),te(r+1))},Ye=async()=>{r>0&&(r===3&&await fe(),te(r-1))},se=async()=>{de(!0),v(5),W({current:1,total:4,message:d==="de"?"Erstelle Gliederung...":d==="fr"?"Creation du plan...":"Generating outline..."});try{await new Promise(l=>setTimeout(l,1500)),W({current:2,total:4,message:d==="de"?"Schreibe Geschichte...":d==="fr"?"Ecriture de l'histoire...":"Writing story..."}),await new Promise(l=>setTimeout(l,1500)),W({current:3,total:4,message:d==="de"?"Erstelle Szenen...":d==="fr"?"Creation des scenes...":"Creating scenes..."}),await new Promise(l=>setTimeout(l,1500));const s=a.find(l=>M.includes(l.id));ge(s?`${s.name}'s Adventure`:"My Magical Story"),me(`--- Page 1 ---
Once upon a time, ${(s==null?void 0:s.name)||"our hero"} set off on a magical adventure.

--- Page 2 ---
The journey was full of wonder and excitement.

--- Page 3 ---
And they all lived happily ever after.`),he([{pageNumber:1,description:"A magical forest at dawn with golden sunlight filtering through the trees"},{pageNumber:2,description:"The hero discovering a hidden treasure in a mysterious cave"},{pageNumber:3,description:"A joyful celebration with friends under a rainbow"}]),W({current:4,total:4,message:d==="de"?"Fertig!":d==="fr"?"Termine!":"Complete!"})}catch(s){console.error("Generation failed:",s)}finally{setTimeout(()=>de(!1),500)}},Qe=()=>{switch(r){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(yt,{selectedType:k,onSelect:s=>{P(s),setTimeout(()=>{const l=document.getElementById("art-style-section");l&&l.scrollIntoView({behavior:"smooth",block:"start"})},100)}}),k&&e.jsx(vt,{selectedStyle:c,onSelect:f})]});case 2:return i?i.photoUrl?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(E,{size:24})," ",n.createCharacters]}),e.jsx(Ft,{character:i,onChange:u,onSave:He,onCancel:()=>u(null),onPhotoChange:pe,isLoading:o})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(E,{size:24})," ",n.createCharacters]}),e.jsx(Tt,{onPhotoSelect:pe}),e.jsx("button",{onClick:()=>u(null),className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:n.cancel})]}):a.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(E,{size:24})," ",n.createCharacters]}),e.jsx(Ct,{characters:a,showSuccessMessage:D,onEdit:We,onDelete:Ke,onCreateAnother:ee,onContinue:be})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(E,{size:24})," ",n.createCharacters]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.startCreating}),e.jsx(ie,{onClick:ee,icon:R,children:d==="de"?"Ersten Charakter erstellen":d==="fr"?"Creer le premier personnage":"Create First Character"})]})]});case 3:return e.jsx(Nt,{characters:a,relationships:S,relationshipTexts:I,onRelationshipChange:Oe,onRelationshipTextChange:(s,l)=>V(x=>({...x,[s]:l})),customRelationships:L,onAddCustomRelationship:Ve});case 4:return e.jsx(wt,{characters:a,mainCharacters:M,onToggleMainCharacter:Je,languageLevel:H,onLanguageLevelChange:_e,pages:q,onPagesChange:Ue,dedication:Y,onDedicationChange:Ie,storyDetails:Q,onStoryDetailsChange:Le,developerMode:h});case 5:return K?e.jsx(At,{title:ce,story:K,sceneImages:Ge,languageLevel:H,isGenerating:Z,developerMode:h,onDownloadTxt:()=>{const s=new Blob([K],{type:"text/plain"}),l=URL.createObjectURL(s),x=document.createElement("a");x.href=l,x.download=`${ce}.txt`,x.click(),URL.revokeObjectURL(l)},onCreateAnother:()=>{me(""),ge(""),he([]),v(1)}}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:n.generateStory}),e.jsx("p",{className:"text-gray-600 mb-6",children:d==="de"?"Bereit, deine Geschichte zu erstellen!":d==="fr"?"PrÃªt Ã  crÃ©er votre histoire!":"Ready to create your story!"}),e.jsx(ie,{onClick:se,size:"lg",icon:R,children:n.generateStory})]});default:return null}};return m?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(at,{currentStep:r,onStepClick:te,canAccessStep:qe,developerMode:h,onDeveloperModeChange:b}),e.jsx("div",{className:"max-w-7xl mx-auto px-3 md:px-8 mt-2 md:mt-8 flex-1",children:e.jsxs("div",{className:"md:bg-white md:rounded-2xl md:shadow-xl md:p-8",children:[o&&!Z?e.jsx("div",{className:"py-12",children:e.jsx(Se,{message:d==="de"?"Laden...":d==="fr"?"Chargement...":"Loading..."})}):Qe(),r<5&&!i&&e.jsxs("div",{className:`mt-6 pt-6 border-t border-gray-200 ${r===4?"space-y-4":"flex justify-between"}`,children:[e.jsxs("button",{onClick:Ye,className:"bg-transparent text-gray-800 hover:bg-gray-100 px-6 py-3 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(dt,{size:20})," ",n.back]}),r!==4&&e.jsxs("button",{onClick:be,disabled:!$(),className:`px-6 py-3 rounded-lg font-semibold flex items-center gap-2 ${$()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[n.next," ",e.jsx(rt,{size:20})]}),r===4&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:se,disabled:!$(),className:`w-full py-3 rounded-lg font-bold text-base flex items-center justify-center gap-2 ${$()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-400 text-white cursor-not-allowed"}`,children:[e.jsx(R,{size:20})," ",n.generateStory]}),h&&e.jsxs("button",{onClick:se,disabled:!$(),className:`w-full py-3 rounded-lg font-bold text-base flex items-center justify-center gap-2 ${$()?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-gray-400 text-white cursor-not-allowed"}`,children:[e.jsx(R,{size:20}),d==="de"?"Nur Text generieren (ohne Bilder)":d==="fr"?"GÃ©nÃ©rer le texte uniquement (sans images)":"Generate Text Only (no images)"]})]})]})]})}),Z&&e.jsx(zt,{current:X.current,total:X.total,message:X.message})]}):e.jsx(Se,{fullScreen:!0})}export{_t as default};
